[
  {
    "id": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
    "data": {},
    "subcollections": {
      "rules": [
        {
          "id": "4b86VS3XzwoDMdkJftDS",
          "data": {
            "id": "4b86VS3XzwoDMdkJftDS",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "DSA Doc Output",
            "description": "",
            "content": "RITICAL OUTPUT REQUIREMENTS:**\n\n1. **Pure Markdown**: Output ONLY markdown content\n   - NO wrapper code blocks (don't wrap the entire document in \\`\\`\\`markdown)\n   - NO additional commentary or meta-text\n   - Start directly with the document title\n\n2. **Content Validation**:\n   - Ensure the document has at least 1000 words (excluding tables and diagrams)\n   - Verify all 4 required sections are present and properly formatted\n   - Confirm 1-2 tables are included and properly formatted\n   - Confirm 2-3 ASCII diagrams are included in code blocks\n   - Check that all markdown syntax is correct\n\n3. **Quality Standards**:\n   - Write in professional technical documentation style\n   - Use accurate technical information\n   - Provide practical, actionable insights\n   - Ensure content directly addresses the user's prompt\n   - Make the document comprehensive but accessible\n\n4. **Structure Compliance**:\n   - Follow the exact section structure: Glossary → Core Concepts → Examples → Summary\n   - Use proper heading levels\n   - Maintain consistent formatting throughout\n",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt"
            ],
            "isDefault": true,
            "createdAt": "2025-11-16T04:57:57.128Z",
            "directoryIds": [
              "B0vn5dW2CtxFrhFimGy5",
              "NRRUgXu8X6kqDUZ2uDNH"
            ],
            "updatedAt": "2026-01-18T03:44:22.273Z"
          },
          "createTime": "2025-11-16T04:57:57.144Z",
          "updateTime": "2026-01-18T03:44:22.294Z"
        },
        {
          "id": "9LKRHY2RCQs5xheRxY0j",
          "data": {
            "id": "9LKRHY2RCQs5xheRxY0j",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Web Firebase CIAI",
            "description": "",
            "content": "# Code Insights AI - Project Structure and Functionality Guide\n\n## Project Overview\n\n**Code Insights AI** is an AI-powered educational platform that helps users learn from documents through intelligent content processing, quiz generation, and personalized followup explanations. The platform uses Google's Gemini AI to transform documents into interactive learning experiences.\n\n### Core Purpose\n- **Document Management**: Scrape, upload, and generate documents from various sources\n- **AI-Powered Learning**: Generate quizzes and followup explanations from documents\n- **Rule-Based Customization**: Define AI behavior rules that cascade through directory hierarchies\n- **Organized Learning**: Directory-based organization with hierarchical rule inheritance\n\n---\n\n## Architecture Overview\n\n### Monorepo Structure (NX Workspace)\nThis project uses **NX 21.5.2** as a monorepo tool with the following structure:\n\n```\ncode-insights-ai/\n├── web/                    # React web application (frontend)\n├── functions/              # Firebase Cloud Functions (backend)\n├── libs/                   # Shared libraries\n│   └── shared-types/       # TypeScript types shared between frontend and backend\n├── scripts/                # Utility scripts (backup, restore, etc.)\n└── docs/                   # Documentation\n```\n\n### Technology Stack\n\n#### Frontend (`web/`)\n- **Framework**: React 19 with TypeScript\n- **Build Tool**: Vite 7\n- **Routing**: React Router DOM v7\n- **State Management**: Redux Toolkit with RTK Query\n- **UI Components**: shadcn/ui (Radix UI primitives)\n- **Styling**: Tailwind CSS with CSS custom properties\n- **Authentication**: Firebase Authentication with react-firebase-hooks\n- **Form Handling**: React Hook Form with Zod validation\n- **Icons**: Lucide React\n- **Date Handling**: date-fns\n\n#### Backend (`functions/`)\n- **Runtime**: Node.js with Firebase Functions v2\n- **AI Integration**: Google Gemini 2.5 Pro API\n- **Database**: Firebase Firestore\n- **Storage**: Firebase Storage\n- **Web Scraping**: Cheerio + node-fetch\n- **TypeScript**: Full type safety with shared types\n\n#### Shared Libraries (`libs/shared-types/`)\n- **Purpose**: TypeScript interfaces and types shared between frontend and backend\n- **Usage**: Prevents type drift and ensures API contract consistency\n\n---\n\n## Directory Structure\n\n### Frontend Structure (`web/src/`)\n\n```\nweb/src/\n├── app/                    # App root component and routing\n│   └── app.tsx            # Main app component with routes\n├── pages/                  # Page components\n│   ├── HomePage/          # Dashboard/home page\n│   ├── AuthPage/          # Authentication page\n│   ├── DocumentsPage/     # Document list and management\n│   ├── CreateDocumentPage/ # Create document from URL/upload/prompt\n│   ├── DocumentViewerPage/ # View document content\n│   ├── QuizPage/          # Take quiz interface\n│   ├── CreateQuizPage/   # Generate quiz from document\n│   ├── MyQuizzesPage/     # List user's quizzes\n│   ├── RulesPage/         # Rules manager (CRUD)\n│   ├── DirectoryRulesPage/ # Manage rules for specific directory\n│   └── ProfilePage/       # User profile\n├── components/            # Reusable UI components\n│   ├── ui/                # shadcn/ui components (Button, Card, Input, etc.)\n│   ├── MainLayout/        # Main app layout with sidebar\n│   ├── Sidebar/           # Navigation sidebar\n│   ├── Toast/             # Toast notifications\n│   └── Page/              # Page wrapper component\n├── contexts/              # React Context providers\n│   ├── AuthContext.tsx    # Authentication state\n│   └── ThemeContext.tsx   # Theme management\n├── store/                 # Redux store configuration\n│   ├── index.ts           # Store setup and configuration\n│   ├── api/               # RTK Query API definitions\n│   └── slices/            # Redux Toolkit slices\n├── hooks/                 # Custom React hooks\n├── lib/                   # Utility functions\n│   └── utils.ts           # Common utilities (cn, etc.)\n├── utils/                 # Helper utilities\n│   └── dateUtils.ts       # Date formatting utilities\n├── config/                 # Configuration files\n└── types/                 # TypeScript type definitions\n```\n\n### Backend Structure (`functions/src/`)\n\n```\nfunctions/src/\n├── index.ts               # Main entry point, exports all endpoints\n├── endpoints/             # Firebase Cloud Functions endpoints\n│   ├── documents.ts      # Document CRUD operations\n│   ├── quizzes.ts        # Quiz generation and management\n│   ├── quiz-followup.ts  # Followup explanation generation\n│   ├── rules.ts          # Rules CRUD and resolution\n│   ├── directories.ts    # Directory management\n│   └── debug-rules.ts   # Debug utilities for rules\n├── services/             # Business logic services\n│   ├── gemini/           # Gemini AI integration\n│   │   ├── gemini.ts     # Main Gemini service\n│   │   ├── json-sanitizer.ts # JSON response sanitization\n│   │   └── prompt-builder/  # Prompt construction\n│   │       ├── document-prompt-builder.ts\n│   │       ├── quiz-prompt-builder.ts\n│   │       ├── followup-prompt-builder.ts\n│   │       └── withContextFiles.ts\n│   ├── document-crud.ts  # Document database operations\n│   ├── document-storage.ts # Firebase Storage operations\n│   ├── rule-crud.ts      # Rule database operations\n│   ├── rule-resolution.ts # Rule inheritance and resolution\n│   ├── directory.ts      # Directory operations\n│   ├── firestore.ts      # Firestore utilities\n│   ├── scraper.ts        # Web scraping service\n│   └── promptBuilder.ts # Legacy prompt builder\n└── types/                # Backend-specific types\n```\n\n---\n\n## Core Features and Functionality\n\n### 1. Document Management\n\n#### Document Sources\n- **URL Scraping**: Scrape web articles and convert to markdown\n- **File Upload**: Upload markdown/text files\n- **AI Generation**: Generate documents from text prompts with optional context files\n\n#### Document Operations\n- Create, read, update, delete documents\n- Organize documents in hierarchical directories\n- Search and filter documents\n- View document content with markdown rendering\n- Track document metadata (word count, reading time, source type)\n\n#### Document Storage\n- Documents stored in Firebase Storage as markdown files\n- Metadata stored in Firestore\n- Download URLs generated for content access\n\n### 2. Quiz Generation\n\n#### Quiz Creation Flow\n1. User selects a document\n2. Optionally selects rules for quiz generation\n3. AI generates quiz with multiple-choice questions\n4. Each question includes:\n   - Question text\n   - 4 answer options\n   - Correct answer index\n   - Explanation for correct answer\n\n#### Quiz Features\n- Multiple quizzes can be generated from the same document\n- Track generation attempts\n- Link quizzes to source documents\n- Store followup rules for later use\n\n### 3. Quiz Followup Generation\n\n#### Followup Flow\n1. User answers a quiz question\n2. System generates personalized explanation document\n3. Explanation considers:\n   - Original document content\n   - Question and user's answer\n   - Correct answer\n   - Optional followup rules\n\n#### Followup Features\n- Creates new document with explanation\n- Uses context from original document\n- Can be customized with followup-specific rules\n\n### 4. Rules System\n\n#### Rule Structure\nRules define how AI should behave for different operations:\n\n```typescript\ninterface Rule {\n  id: string;\n  userId: string;\n  name: string;\n  description?: string;\n  content: string;        // Markdown content (max 10,000 chars)\n  color: RuleColor;        // Visual categorization\n  tags: string[];          // Filtering and organization\n  applicableTo: RuleApplicability[]; // Which operations this applies to\n  isDefault: boolean;      // Auto-selected by default\n  directoryIds: string[];  // Directories this rule is attached to\n}\n```\n\n#### Rule Applicability Types\n- `SCRAPING`: Rules for web scraping operations\n- `UPLOAD`: Rules for file upload processing\n- `PROMPT`: Rules for text prompt generation\n- `QUIZ`: Rules for quiz generation\n- `FOLLOWUP`: Rules for followup explanation generation\n\n#### Rule Inheritance\n- Rules attached to directories cascade to subdirectories\n- Child directories inherit all parent directory rules\n- Rules are numbered hierarchically when injected into prompts (e.g., \"RULE #1\", \"RULE #2\")\n- AI resolves rule conflicts intelligently\n\n#### Rule Operations\n- Create, read, update, delete rules\n- Attach/detach rules to/from directories\n- Filter rules by tags and applicability\n- Format rules for prompt injection\n\n### 5. Directory System\n\n#### Directory Structure\n- Hierarchical directory tree (max depth: 10 levels)\n- Each directory can contain:\n  - Subdirectories\n  - Documents\n- Directory metadata:\n  - Name, path, parent reference\n  - Color and icon for visual organization\n  - Cached counts (documents, children)\n\n#### Directory Operations\n- Create, update, delete directories\n- Move directories (updates all descendant paths)\n- Get directory tree for navigation\n- Get directory contents (subdirectories + documents)\n- Get directory ancestors for breadcrumbs\n\n#### Directory Rules Integration\n- Rules can be attached to any directory\n- Rules cascade to all subdirectories\n- Get applicable rules for a directory and operation type\n- Rules are resolved hierarchically (parent → child)\n\n---\n\n## Data Models\n\n### Document Model\n\n```typescript\ninterface DocumentEnhanced {\n  id: string;\n  userId: string;\n  title: string;\n  description: string;\n  sourceType: 'url' | 'upload' | 'generated';\n  sourceUrl?: string;\n  wordCount: number;\n  status: 'active' | 'archived' | 'deleted';\n  storageUrl: string;        // Firebase Storage download URL\n  storagePath: string;      // Storage path\n  tags: string[];\n  directoryId?: string;     // Optional directory placement\n  createdAt: Date | FirestoreTimestamp;\n  updatedAt: Date | FirestoreTimestamp;\n}\n```\n\n### Quiz Model\n\n```typescript\ninterface Quiz {\n  id: string;\n  documentId: string;       // Source document reference\n  title: string;\n  questions: QuizQuestion[];\n  createdAt: Date;\n  userId: string;\n  generationAttempt?: number;\n  documentTitle?: string;   // Cached for performance\n  followupRuleIds?: string[]; // Rules for followup generation\n}\n\ninterface QuizQuestion {\n  question: string;\n  options: string[];        // 4 options\n  correctAnswer: number;    // Index of correct option\n  explanation: string;      // Mandatory explanation\n}\n```\n\n### Directory Model\n\n```typescript\ninterface Directory {\n  id: string;\n  userId: string;\n  name: string;\n  parentId: string | null;  // null for root directories\n  path: string;             // Computed path (e.g., \"/Projects/Web\")\n  level: number;             // Tree depth (0 for root)\n  color?: string;\n  icon?: string;\n  documentCount: number;    // Cached count\n  childCount: number;       // Cached count\n  ruleIds: string[];       // Denormalized for quick access\n  createdAt: Date | FirestoreTimestamp;\n  updatedAt: Date | FirestoreTimestamp;\n}\n```\n\n### Rule Model\n\n```typescript\ninterface Rule {\n  id: string;\n  userId: string;\n  name: string;\n  description?: string;\n  content: string;          // Markdown, max 10,000 chars\n  color: RuleColor;\n  tags: string[];\n  applicableTo: RuleApplicability[];\n  isDefault: boolean;\n  directoryIds: string[];    // Directories this rule is attached to\n  createdAt: Date | FirestoreTimestamp;\n  updatedAt: Date | FirestoreTimestamp;\n}\n```\n\n---\n\n## API Endpoints\n\n### Document Endpoints\n- `createDocument` - Create document from content\n- `createDocumentFromUrl` - Scrape URL and create document\n- `generateFromPrompt` - Generate document from text prompt\n- `getDocument` - Get document metadata\n- `getDocumentWithContent` - Get document with full content\n- `updateDocument` - Update document\n- `deleteDocument` - Delete document and associated quizzes\n- `getUserDocuments` - List user's documents\n- `listDocuments` - List documents with pagination\n- `searchDocuments` - Search documents\n- `getDocumentStats` - Get document statistics\n\n### Quiz Endpoints\n- `generateQuiz` - Generate quiz from document\n- `getQuiz` - Get quiz by ID\n- `getUserQuizzes` - List user's quizzes\n- `getRecentQuizzes` - Get recently created quizzes\n- `getDocumentQuizzes` - Get quizzes for a document\n- `deleteQuiz` - Delete quiz\n\n### Quiz Followup Endpoints\n- `generateQuizFollowup` - Generate followup explanation document\n\n### Rules Endpoints\n- `createRule` - Create new rule\n- `getRule` - Get rule by ID\n- `getRules` - List user's rules (with filtering)\n- `updateRule` - Update rule\n- `deleteRule` - Delete rule (if not attached to directories)\n- `attachRuleToDirectory` - Attach rule to directory\n- `detachRuleFromDirectory` - Detach rule from directory\n- `getDirectoryRules` - Get rules for directory (with inheritance)\n- `getApplicableRules` - Get rules applicable to operation type\n- `formatRulesForPrompt` - Format rules for AI prompt injection\n- `getRuleTags` - Get all unique tags\n\n### Directory Endpoints\n- `createDirectory` - Create new directory\n- `getDirectory` - Get directory by ID\n- `updateDirectory` - Update directory\n- `deleteDirectory` - Delete directory and contents\n- `getDirectoryTree` - Get full directory tree\n- `getDirectoryContents` - Get directory contents\n- `getDirectoryAncestors` - Get directory ancestors for breadcrumbs\n- `moveDirectory` - Move directory to new parent\n\n---\n\n## Key Patterns and Conventions\n\n### Frontend Patterns\n\n#### Page Structure\nEach page follows this structure:\n```\nPageName/\n├── index.ts                    # Exports\n├── PageName.tsx                # Main page component\n├── PageNameContainer/          # Container component\n│   ├── index.ts\n│   └── PageNameContainer.tsx\n├── context/                    # Page-specific context\n│   ├── PageNameContext.ts\n│   ├── PageNameProvider.tsx\n│   └── hooks/                  # Page-specific hooks\n│       ├── api/                # API hooks (RTK Query)\n│       ├── usePageNameForm.ts  # Form hooks\n│       ├── usePageNameHandlers.ts # Event handlers\n│       └── usePageNameEffects.ts  # Side effects\n└── types/                      # Page-specific types\n```\n\n#### State Management\n- **Redux Toolkit**: Global state and API calls (RTK Query)\n- **React Context**: Page-specific state and handlers\n- **React Hook Form**: Form state management\n- **Zod**: Schema validation for forms and API data\n\n#### Component Organization\n- **Global Components**: Reusable across app (`web/src/components/`)\n- **Container Components**: Page-specific (`PageNameContainer/`)\n- **UI Components**: shadcn/ui primitives (`components/ui/`)\n\n### Backend Patterns\n\n#### Service Layer\n- Business logic separated into service files\n- Services handle database operations, AI calls, and data transformation\n- Endpoints are thin wrappers that validate and call services\n\n#### Error Handling\n- All endpoints use try-catch blocks\n- Firebase Functions errors use `HttpsError` for proper HTTP status codes\n- Authentication validated in middleware\n\n#### Type Safety\n\n\n",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt",
              "followup"
            ],
            "isDefault": true,
            "createdAt": "2025-11-16T04:59:53.783Z",
            "directoryIds": [
              "hFUT7IkkGQHbUeMywY1G"
            ],
            "updatedAt": "2025-11-16T05:01:46.405Z"
          },
          "createTime": "2025-11-16T04:59:53.803Z",
          "updateTime": "2025-11-16T05:01:46.423Z"
        },
        {
          "id": "AQ7LG6xPp6wJ4rU8LRgc",
          "data": {
            "id": "AQ7LG6xPp6wJ4rU8LRgc",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "DSA ASCII Diag",
            "description": "",
            "content": "---\ndescription: Rules for creating comprehensive ASCII diagrams and visual explanations for algorithm solutions\nglobs: [\"**/*.md\", \"**/*.txt\", \"**/*.js\"]\nalwaysApply: false\n---\n\n# Algorithm Diagram Creation Rules\n\n## Core Principles\n\n1. **Always supplement code with visual explanations** when solving algorithm problems\n2. **Use step-by-step walkthroughs** with concrete examples\n3. **Show state transitions** and data structure changes\n4. **Include both high-level flow and detailed execution traces**\n\n## Diagram Types and Patterns\n\n### 1. Step-by-Step Algorithm Walkthrough\n\n**Use for:** Array operations, string processing, iterative algorithms\n\n**Format:**\n```\n=== Step N ===\nState: [description of current state]\nVariables: var1=value, var2=value\nAction: [what happens in this step]\nResult: [new state after action]\n```\n\n**Example structure:**\n- Show initial state\n- Number each step clearly\n- Display variable values at each step\n- Use arrows (→, ↓, ↑) to show movement/direction\n- Mark important transitions with ✅/❌\n\n### 2. Table/Matrix Building Visualization\n\n**Use for:** Dynamic programming, 2D array problems\n\n**Format:**\n```\n      j=0  j=1  j=2  j=3\n    +-------------------+\ni=0 | T  |  F |  T |  F |\n    |    | ↗  | ↗  | ↗  |\ni=1 |    | T  |  F | T  |\n    |    |    | ↗  | ↗  |\ni=2 |    |    | T  |  F |\n    +-------------------+\n```\n\n**Guidelines:**\n- Show dependency arrows (↗, ↑, ←) between cells\n- Use different lengths for different iterations\n- Mark computed vs. base cases\n- Include row/column headers with meaningful labels\n- Show the filling order with numbered steps\n\n### 3. Recursion Trees and Call Stacks\n\n**Use for:** Recursive algorithms, backtracking, tree traversal\n\n**Tree Format:**\n```\n                dfs(0)\n            /\"substring\"\\\n           /              \\\n      \"word1\" ✓          \"word2\" ✓\n         /                    \\\n     dfs(5)                dfs(6)\n    /\"rest\"\\              /\"rest2\"\\\n   /        \\             /        \\\n```\n\n**Call Stack Format:**\n```\nStep 1:          Step 2:          Step 3:\n+-----------+    +-----------+    +-----------+\n| dfs(0)    |    | dfs(0)    |    | dfs(0)    |\n+-----------+    +-----------+    +-----------+\n                 | dfs(3)    |    | dfs(3)    |\n                 +-----------+    +-----------+\n                                 | dfs(7)    |\n                                 +-----------+\n```\n\n**Guidelines:**\n- Show both tree structure and linear call stack\n- Mark base cases clearly\n- Include parameter values in function calls\n- Use ✓/❌ to show valid/invalid paths\n- Show return values flowing back up\n\n### 4. Flow Diagrams for Processes\n\n**Use for:** Encoding/decoding, parsing, state machines\n\n**Format:**\n```\nInput: [initial_data]\n  |\n  | Process Step 1\n  v\nIntermediate: [transformed_data]\n  |\n  | Process Step 2  \n  v\nOutput: [final_result]\n```\n\n**Guidelines:**\n- Use boxes for states/data\n- Use arrows with labels for transitions\n- Show concrete examples alongside general form\n- Include edge cases and special conditions\n\n### 5. Index and Pointer Visualization\n\n**Use for:** Two pointers, sliding window, array manipulation\n\n**Format:**\n```\nArray:    [a, b, c, d, e, f]\nIndexes:   0  1  2  3  4  5\n           ^     ^\n           i     j\n```\n\n**Guidelines:**\n- Always show both data and indices\n- Use ^ or ↑ to mark pointer positions\n- Show pointer movement across iterations\n- Include range markers for subarrays [i...j]\n\n### 6. Constraint Propagation\n\n**Use for:** Digit DP, constrained search, backtracking with pruning\n\n**Format:**\n```\nPosition 0 (tight=true):\n├─ digit=0 → tight=false (freedom for rest)\n├─ digit=1 → tight=false (freedom for rest)  \n└─ digit=2 → tight=true  (constrained)\n             │\n             Position 1 (tight=true):\n             ├─ digit=0,1,2,3 only\n             └─ digit>3 invalid ❌\n```\n\n## Anti-Patterns to Avoid\n\n- ❌ **Incomplete diagrams** that cut off mid-flow (CRITICAL: always show start to finish)\n- ❌ **Mixed box styles** (never mix double-line, single-line, or ASCII boxes in one diagram)\n- ❌ Diagrams without concrete examples\n- ❌ Missing intermediate steps in complex algorithms  \n- ❌ Inconsistent notation or symbols\n- ❌ Diagrams that don't match the actual code implementation\n- ❌ Over-complicated visuals that obscure rather than clarify\n- ❌ Missing explanations of why each step works\n- ❌ Poor alignment and spacing that makes diagrams hard to read\n\n## When to Create Diagrams\n\n**Always create diagrams for:**\n- Recursive algorithms (show call tree + execution trace)\n- Dynamic programming (show table building process)\n- Graph algorithms (show traversal and state changes)\n- Complex data structure operations\n- Algorithms with non-obvious state transitions\n\n**Consider diagrams for:**\n- Optimization problems with multiple approaches\n- Algorithms with intricate loop logic\n- Problems involving coordinate systems or 2D grids\n- Parsing and string manipulation algorithms\n\nRemember: The goal is to make complex algorithms accessible and understandable. A good diagram should enable someone to implement the algorithm just from the visual explanation.\n\n## Formatting Standards\n\n### Typography\n- Use `monospace` for code elements and variable names\n- Use **bold** for important concepts\n- Use *italics* for explanations and notes\n- Use → ↑ ↓ ← for directional flow\n- Use ✅ ❌ for valid/invalid states\n- Use ╔═╗ ║ ╚═╝ for emphasis boxes when needed\n\n### Structure\n- Always start with problem statement and example\n- Include both algorithmic overview and detailed trace\n- End with key insights and complexity analysis\n- Use horizontal rules (===) to separate major sections\n- Number steps consistently (1, 2, 3... or Step A, Step B...)\n\n### Code Integration\n- Reference specific line numbers when explaining code\n- Show variable states alongside code execution\n- Include memoization cache states for DP problems\n- Highlight the relationship between code and diagram\n\n### Consistency Requirements for Flow Diagrams\n\n**CRITICAL: Diagrams must be COMPLETE and CONSISTENT**\n\n#### 1. Completeness - Never Cut Off Mid-Flow\n- ❌ **NEVER create incomplete diagrams** that stop mid-process\n- ✅ **ALWAYS complete** the entire algorithm flow from start to finish\n- ✅ Show the full path: Start → All Steps → End\n- ✅ If showing a process, include ALL steps, not just the beginning\n- ✅ If simplifying, clearly mark it as \"simplified\" and show the complete flow\n\n#### 2. Consistent Box Formatting\nChoose ONE style and use it consistently throughout the entire diagram:\n\n**Option A: Double-line boxes (for emphasis)**\n```\n╔═══════════════════╗\n║   Box Content     ║\n╚═══════════════════╝\n```\n- Use `═` for horizontal lines\n- Use `║` for vertical lines  \n- Use `╔` `╗` `╚` `╝` for corners\n\n**Option B: Single-line boxes (simple and clean)**\n```\n┌───────────────────┐\n│   Box Content     │\n└───────────────────┘\n```\n- Use `─` for horizontal lines\n- Use `│` for vertical lines\n- Use `┌` `┐` `└` `┘` for corners\n\n**Option C: ASCII-only boxes (most compatible)**\n```\n+-------------------+\n|   Box Content     |\n+-------------------+\n```\n- Use `-` for horizontal lines\n- Use `|` for vertical lines\n- Use `+` for corners\n\n**CRITICAL RULE:** Never mix different box styles in the same diagram!\n\n#### 3. Complete Flow Structure\nEvery flow diagram must have:\n- **Clear start point** (title/header box or labeled entry)\n- **Complete flow path** (all intermediate steps shown)\n- **Clear end point** (final result box or continuation indicator)\n- **Consistent arrow direction** (use → ↓ ↑ ← consistently)\n\n#### 4. Proper Alignment and Spacing\n- Maintain consistent indentation throughout\n- Align boxes vertically and horizontally\n- Use consistent spacing between elements (2-4 spaces)\n- Ensure arrows align properly with boxes\n- Use proper line breaks for readability\n\n#### 5. Example: Good vs Bad\n\n**❌ BAD (Incomplete, inconsistent):**\n```\n╔════════════════════════════════════╗\n║  Reconstruction Algorithm Overview ║\n╚═══════════════╦════════════════════╝\n                ↓\n        ┌───────────────────────┐\n        │  Get Root from Preorder  │\n        └───────────────┬───────┘\n                ↓\n```\n\n**Problems:**\n- Diagram cuts off mid-flow (no completion)\n- Mixed box styles (double-line header, single-line boxes)\n- No end point shown\n- Incomplete algorithm representation\n\n**✅ GOOD (Complete, consistent single-line style):**\n```\n┌────────────────────────────────────┐\n│ Reconstruction Algorithm Overview  │\n└───────────────┬────────────────────┘\n                ↓\n        ┌────────────────────────┐\n        │ Get Root from Preorder │\n        └───────────────┬────────┘\n                        ↓\n        ┌───────────────────────┐\n        │ Find Root in Inorder  │\n        └───────────────┬───────┘\n                        ↓\n        ┌────────────────────────┐\n        │ Split Arrays & Recurse │\n        └───────────────┬────────┘\n                        ↓\n        ┌───────────────────────┐\n        │   Return Root Node    │\n        └───────────────────────┘\n```\n\n**Why it's good:**\n- Complete flow from start to finish\n- Consistent box style (single-line throughout, including header)\n- All steps shown\n- Clear start and end points\n- Proper alignment: arrows centered, boxes aligned vertically\n- Consistent spacing and indentation\n\n**✅ ALTERNATIVE GOOD (Consistent double-line style):**\n```\n╔════════════════════════════════════╗\n║  Reconstruction Algorithm Overview ║\n╚═══════════════╦════════════════════╝\n                ↓\n        ╔════════════════════════╗\n        ║ Get Root from Preorder ║\n        ╚═══════════════╦════════╝\n                        ↓\n        ╔═══════════════════════╗\n        ║ Find Root in Inorder  ║\n        ╚═══════════════╦═══════╝\n                        ↓\n        ╔════════════════════════╗\n        ║ Split Arrays & Recurse ║\n        ╚═══════════════╦════════╝\n                        ↓\n        ╔═══════════════════════╗\n        ║   Return Root Node    ║\n        ╚═══════════════════════╝\n```\n\n#### 6. Quick Consistency Checklist\nBefore finalizing any flow diagram, verify:\n- [ ] Diagram is complete (has clear start AND end)\n- [ ] Uses consistent box characters throughout (no mixing styles)\n- [ ] All steps in the process are shown\n- [ ] Properly aligned vertically and horizontally\n- [ ] Consistent spacing between elements\n- [ ] Arrows align properly with boxes\n- [ ] Readable and clear in plain text format\n- [ ] If simplified, clearly marked as such\n\n## Required Sections for Complex Algorithms\n\n1. **Problem Setup:** Input, output, constraints\n2. **Algorithm Overview:** High-level approach diagram\n3. **Detailed Walkthrough:** Step-by-step with concrete example\n4. **State Visualization:** Data structure changes over time\n5. **Edge Cases:** Special conditions and boundary handling\n6. **Key Insights:** What makes the algorithm work\n7. **Complexity Analysis:** Time/space with justification\n\n## Examples of Good Diagram Comments\n\n```javascript\n// Visual representation of the encoding process:\n// Input: [\"hello\", \"world\"]\n// Step 1: \"hello\" → \"5#hello\"  \n// Step 2: \"world\" → \"5#world\"\n// Result: \"5#hello5#world\"\n```\n\n```javascript\n// Recursion tree for dfs(startIndex):\n//       dfs(0)\n//      /      \\\n//   \"cat\"    \"cats\"  \n//    |         |\n//  dfs(3)    dfs(4)\n//    |         |\n//  \"sand\"    \"and\"\n```\n\ndescription:\nglobs:\nalwaysApply: false\n---\n",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt",
              "followup"
            ],
            "createdAt": "2025-11-16T04:56:52.209Z",
            "isDefault": true,
            "directoryIds": [
              "B0vn5dW2CtxFrhFimGy5",
              "NRRUgXu8X6kqDUZ2uDNH",
              "IAmZcUL0a5hF0s2soG9V"
            ],
            "updatedAt": "2026-01-25T03:27:26.680Z"
          },
          "createTime": "2025-11-16T04:56:52.237Z",
          "updateTime": "2026-01-25T03:27:26.717Z"
        },
        {
          "id": "CyJnwN3fsKHqtfPz8XBU",
          "data": {
            "id": "CyJnwN3fsKHqtfPz8XBU",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Cantonese Quiz",
            "description": "",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "quiz"
            ],
            "isDefault": true,
            "createdAt": "2025-11-28T10:58:12.508Z",
            "directoryIds": [
              "raI9erLcbUR3h35N5kD1"
            ],
            "content": "IMPORTANT! THE QUIZ SHOULD BE IN CANTONESE LANGUAGE!\n# Cantonese Quiz Generation Rules\n\nThese rules are specific to quiz generation based on Cantonese text that has been transformed using the `cantonese-text-transformation.md` rule. They build upon the generic quiz rules and add Cantonese-specific requirements for linguistic accuracy and pedagogical effectiveness.\n\n## IMPORTANT: Prerequisites\n\n**This rule MUST be used in conjunction with:**\n- `cantonese-text-transformation.md` - Defines the mandatory transformation rule for converting standardized Chinese to Cantonese with Jyutping annotations\n- `quiz-generic.md` - Defines core quiz structure, option quality requirements, and JSON formatting rules\n\n**The quiz generation agent MUST:**\n1. Work with Cantonese text that has already been transformed according to `cantonese-text-transformation.md`\n2. Generate questions and answer options entirely in Cantonese\n3. Use natural Cantonese colloquial speech patterns\n4. Reference Jyutping annotations when appropriate for clarity\n\n## Cantonese Language Requirements\n\n### Question Language (MANDATORY)\n- ✅ **ALL questions MUST be written in Cantonese colloquial form**\n- ✅ **Use natural Cantonese speech patterns and vocabulary**\n- ✅ **Questions should sound natural and conversational in Cantonese**\n- ✅ **Use appropriate Cantonese particles (嘅, 咗, 喇, 呀, etc.)**\n- ❌ **NEVER use standardized Chinese (Mandarin) in questions**\n- ❌ **NEVER mix Cantonese and Mandarin in the same question**\n- ❌ **AVOID formal written Chinese structures**\n\n### Answer Option Language (MANDATORY)\n- ✅ **ALL answer options MUST be written in Cantonese colloquial form**\n- ✅ **All four options must use consistent Cantonese language style**\n- ✅ **Options should use natural Cantonese expressions and vocabulary**\n- ✅ **Maintain consistent formality level across all options**\n- ❌ **NEVER use standardized Chinese (Mandarin) in answer options**\n- ❌ **NEVER mix languages within options**\n- ❌ **AVOID overly formal or literary Cantonese unless contextually appropriate**\n\n### Jyutping Usage in Questions\n- **Optional but Recommended**: Include Jyutping in parentheses for clarity when:\n  - The question references specific words from the annotated text\n  - Technical or less common vocabulary is used\n  - Pronunciation clarity would help learners\n- **Format**: `[word in cantonese] ([jyutping])` or `word ([jyutping])`\n- **Example**: `邊個詞語 ([bin1 go3 ci4 jyu5]) 表示「好」嘅意思？`\n\n## Question Types for Cantonese Text\n\n### Required Question Categories\nEach Cantonese quiz should include questions covering:\n\n1. **Vocabulary Understanding** (2-3 questions)\n   - Meaning of specific Cantonese words from the text\n   - Word usage in context\n   - Synonyms or related vocabulary\n\n2. **Grammar Patterns** (2-3 questions)\n   - Use of Cantonese particles (嘅, 咗, 喇, 呀, 喺, etc.)\n   - Sentence structure and word order\n   - Question formations\n   - Negative constructions (唔, 冇)\n\n3. **Comprehension** (2-3 questions)\n   - Main ideas and central concepts\n   - Supporting details from the text\n   - Inferences and implications\n\n4. **Cultural Context** (1-2 questions)\n   - Cantonese-specific expressions\n   - Cultural nuances in the text\n   - Appropriate usage contexts\n\n5. **Text Analysis** (1-2 questions)\n   - Understanding relationships between ideas\n   - Identifying key information\n   - Drawing conclusions\n\n## Cantonese-Specific Question Examples\n\n### Vocabulary Questions\n**GOOD Example:**\n```\nQuestion: \"文中「學生」([hok6 saang1]) 呢個詞係指乜嘢？\"\nOptions:\nA. 指讀書嘅人 ([zi2 duk6 syu1 ge3 jan4])\nB. 指教書嘅人 ([zi2 gaau3 syu1 ge3 jan4])\nC. 指寫字嘅人 ([zi2 se2 zi6 ge3 jan4])\nD. 指講話嘅人 ([zi2 gong2 waa6 ge3 jan4])\n```\n\n**BAD Example (using Mandarin):**\n```\nQuestion: \"文中的「學生」是指什麼？\"  ❌ (Mandarin, not Cantonese)\n```\n\n### Grammar Pattern Questions\n**GOOD Example:**\n```\nQuestion: \"「我係學生」入面，「係」([hai6]) 呢個字有乜嘢作用？\"\nOptions:\nA. 表示擁有或者屬於 ([biu2 si6 jung5 jau5 waak6 ze2 syu6 jyu4])\nB. 表示身份或者狀態 ([biu2 si6 san1 fan2 waak6 ze2 zong6 taai3])\nC. 表示動作或者行為 ([biu2 si6 dung6 zok3 waak6 ze2 hang4 wai4])\nD. 表示時間或者地點 ([biu2 si6 si4 gaan3 waak6 ze2 dei6 dim2])\n```\n\n### Comprehension Questions\n**GOOD Example:**\n```\nQuestion: \"根據文章內容，作者想表達乜嘢主要意思？\"\nOptions:\nA. 介紹自己嘅身份同職業 ([gaai3 siu6 zi6 gei2 ge3 san1 fan2 tung4 zik1 jip6])\nB. 說明學習嘅重要性同方法 ([syut3 ming4 hok6 zaap6 ge3 zung6 jiu3 sing3 tung4 fong1 faat3])\nC. 描述日常生活嘅習慣同安排 ([miu4 syut6 jat6 sang1 wut6 ge3 zaap6 gwaan3 tung4 on1 paai4])\nD. 解釋語言學習嘅困難同挑戰 ([gaai2 sik1 jyu5 jin4 hok6 zaap6 ge3 kwan4 naan4 tung4 ziu2 zin3])\n```\n\n## Option Quality Standards for Cantonese Quizzes\n\n### Language Consistency (MANDATORY)\n- ✅ **All four options must use identical Cantonese language style**\n- ✅ **Maintain consistent formality level (colloquial vs. formal)**\n- ✅ **Use consistent particle usage patterns**\n- ✅ **Ensure all options sound natural in Cantonese**\n- ❌ **NEVER mix different language registers**\n- ❌ **AVOID inconsistent particle usage**\n\n### Length Balance (MANDATORY)\n- ✅ **All options must be approximately the same length (within 5-10 words)**\n- ✅ **Count words in Cantonese (not characters)**\n- ✅ **Balance complexity of expressions across options**\n- ❌ **NEVER make correct answer significantly longer/shorter**\n\n**Example of GOOD balanced Cantonese options:**\n```\nA. 表示身份或者狀態嘅動詞 ([biu2 si6 san1 fan2 waak6 ze2 zong6 taai3 ge3 dung6 ci4])\nB. 表示動作或者行為嘅動詞 ([biu2 si6 dung6 zok3 waak6 ze2 hang4 wai4 ge3 dung6 ci4])\nC. 表示時間或者地點嘅介詞 ([biu2 si6 si4 gaan3 waak6 ze2 dei6 dim2 ge3 gaai3 ci4])\nD. 表示擁有或者屬於嘅動詞 ([biu2 si6 jung5 jau5 waak6 ze2 syu6 jyu4 ge3 dung6 ci4])\n```\n\n### Plausible Incorrect Options\n- ✅ **All incorrect options must use relevant Cantonese vocabulary from the text**\n- ✅ **Use Cantonese grammar patterns appropriately (even if incorrectly applied)**\n- ✅ **Make incorrect options sound reasonable in Cantonese context**\n- ✅ **Base incorrect options on common Cantonese learning misconceptions**\n- ❌ **NEVER use unrelated or nonsensical Cantonese expressions**\n\n## Reference to Annotated Text\n\n### Using Jyutping Annotations\nWhen questions reference specific words from the annotated text:\n- ✅ **Include Jyutping in parentheses for clarity**: `「學生」([hok6 saang1])`\n- ✅ **Reference the exact format from the annotated text when relevant**\n- ✅ **Use Jyutping to disambiguate homophones when needed**\n- ❌ **AVOID overusing Jyutping - only when it adds clarity**\n\n### Text Reference Format\n- **Format**: `文中「[word]」([jyutping])` or `文章入面「[word]」([jyutping])`\n- **Example**: `文中「學生」([hok6 saang1]) 呢個詞係指乜嘢？`\n\n## Explanation Requirements\n\n### Cantonese Explanations (MANDATORY)\n- ✅ **ALL explanations MUST be written in Cantonese**\n- ✅ **Use natural Cantonese to explain why the answer is correct**\n- ✅ **Clarify why incorrect options are wrong using Cantonese**\n- ✅ **Reference specific Cantonese grammar patterns or vocabulary when relevant**\n- ❌ **NEVER write explanations in Mandarin or English**\n- ❌ **AVOID overly formal explanations unless contextually appropriate**\n\n**Example of GOOD Cantonese explanation:**\n```\nExplanation: \"「係」([hai6]) 係一個動詞，用嚟表示身份或者狀態。例如「我係學生」表示「我」嘅身份係「學生」。其他選項都唔啱，因為「係」唔係用嚟表示動作、時間或者擁有。\"\n```\n\n## Integration with Generic Rules\n\nThese Cantonese-specific rules **extend and complement** the generic quiz rules. Always follow:\n\n1. **Generic rules** (`quiz-generic.md`) for:\n   - Question count (8-12 questions)\n   - Answer distribution patterns\n   - JSON formatting requirements\n   - Option length balance\n   - Option relevance requirements\n\n2. **Cantonese-specific rules** for:\n   - Language requirements (all Cantonese)\n   - Cantonese grammar and vocabulary\n   - Jyutping usage\n   - Cultural context questions\n\n## Quality Checklist for Cantonese Quizzes\n\nBefore finalizing, verify:\n\n### Language Accuracy\n- [ ] All questions are in natural Cantonese colloquial form\n- [ ] All answer options are in Cantonese\n- [ ] No Mandarin or standardized Chinese mixed in\n- [ ] Consistent Cantonese language style throughout\n- [ ] Appropriate use of Cantonese particles\n\n### Question Coverage\n- [ ] Includes vocabulary understanding questions\n- [ ] Includes grammar pattern questions\n- [ ] Includes comprehension questions\n- [ ] Includes cultural context questions (if applicable)\n- [ ] Covers main concepts from the Cantonese text\n\n### Option Quality\n- [ ] All options use legitimate Cantonese vocabulary\n- [ ] Incorrect options are plausible in Cantonese context\n- [ ] Options are balanced in length (per generic rules)\n- [ ] Options are topically relevant (per generic rules)\n- [ ] Consistent Cantonese language style across all options\n\n### Explanations\n- [ ] All explanations are in Cantonese\n- [ ] Explanations clarify why the answer is correct\n- [ ] Explanations distinguish from incorrect options\n- [ ] Appropriate use of Cantonese grammar terminology\n\n### Text Reference\n- [ ] Questions appropriately reference the annotated Cantonese text\n- [ ] Jyutping used when it adds clarity\n- [ ] References match the format from `cantonese-text-transformation.md`\n\n## Example Complete Quiz Question\n\n```json\n{\n  \"question\": \"文中「學生」([hok6 saang1]) 呢個詞係指乜嘢？\",\n  \"options\": [\n    \"指讀書嘅人 ([zi2 duk6 syu1 ge3 jan4])\",\n    \"指教書嘅人 ([zi2 gaau3 syu1 ge3 jan4])\",\n    \"指寫字嘅人 ([zi2 se2 zi6 ge3 jan4])\",\n    \"指講話嘅人 ([zi2 gong2 waa6 ge3 jan4])\"\n  ],\n  \"correctAnswer\": 0,\n  \"explanation\": \"「學生」([hok6 saang1]) 係指讀書嘅人，即係喺學校學習嘅人。「教書嘅人」係「老師」，「寫字嘅人」同「講話嘅人」都唔係「學生」嘅意思。\"\n}\n```\n\n## Common Pitfalls to Avoid\n\n### Language Mixing\n- ❌ **WRONG**: Mixing Cantonese questions with Mandarin options\n- ❌ **WRONG**: Using standardized Chinese vocabulary in Cantonese context\n- ✅ **CORRECT**: Consistent Cantonese throughout\n\n### Overly Formal Language\n- ❌ **WRONG**: Using literary or formal Chinese structures\n- ✅ **CORRECT**: Natural colloquial Cantonese appropriate to the text\n\n### Incorrect Jyutping Usage\n- ❌ **WRONG**: Including Jyutping in every word unnecessarily\n- ✅ **CORRECT**: Using Jyutping only when it adds clarity or references annotated text\n\n### Inconsistent Particles\n- ❌ **WRONG**: Mixing different particle usage patterns across options\n- ✅ **CORRECT**: Consistent particle usage appropriate to the context\n\n## Best Practices\n\n1. **Read the annotated Cantonese text carefully** before generating questions\n2. **Use vocabulary and expressions from the text** in questions and options\n3. **Maintain natural Cantonese flow** - questions should sound conversational\n4. **Reference Jyutping strategically** - only when it helps clarify meaning\n5. **Test language consistency** - ensure all options sound equally natural in Cantonese\n6. **Consider learner level** - match complexity to the source text difficulty\n\n",
            "updatedAt": "2025-11-28T12:01:16.042Z"
          },
          "createTime": "2025-11-28T10:58:12.527Z",
          "updateTime": "2025-11-28T12:01:16.061Z"
        },
        {
          "id": "DzT5b5b7tyXdWpQ30HX9",
          "data": {
            "id": "DzT5b5b7tyXdWpQ30HX9",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Cantonese Text Transform",
            "description": "",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt"
            ],
            "isDefault": true,
            "createdAt": "2025-11-16T05:26:12.775Z",
            "directoryIds": [
              "3HT3vZUBFEDDFrkEIegz",
              "raI9erLcbUR3h35N5kD1"
            ],
            "content": "# Rules for AI Cantonese Text Transformer\n\n## IMPORTANT: This is a MANDATORY Transformation Rule\n\n**This document defines a mandatory transformation rule that MUST be applied when processing Chinese text input.** When the AI receives text written in Chinese, it MUST apply this transformation rule to convert the input to the specified output format.\n\n**This is NOT a general question about Jyutping transformation.** This is a specific instruction/rule that the AI system must follow when transforming Chinese text.\n\n**IMPORTANT**: This rule must be used in conjunction with `annotated-text-overflow-wrapping.md` which defines mandatory markdown formatting requirements for the \"Annotated Text\" section, including line length limits, sentence splitting, and proper placement in the markdown body (not in code blocks).\n\n### Transformation Rule Summary\n\nWhen given input text written in Chinese:\n1. **MUST** convert standardized Chinese to Cantonese colloquial text\n2. **MUST** transform each word to the format: `[word in cantonese] ([jyutping] - [english translation])`\n3. **MUST** preserve punctuation and non-word elements as-is\n\nThe AI processes the text to provide linguistic annotations, grammar analysis, and visual schemas. The transformation aims to aid language learners by converting standardized Chinese to natural Cantonese, breaking down the text into words with Jyutping transliteration and English translations, followed by sections on grammar patterns and their visualizations.\n\n## Input Requirements\n\n### Input Type\nA string of standardized Chinese text (simplified or traditional characters). The text can be a sentence, paragraph, or short passage. The input may be in written Chinese form that needs to be converted to Cantonese colloquial speech.\n\n### Assumptions\n- The input text is in standardized Chinese (written form), which should be automatically transformed to Cantonese colloquial text.\n- The AI must perform a two-step transformation:\n  1. **Text Conversion**: Automatically convert standardized Chinese to natural colloquial Cantonese text.\n  2. **Annotation**: Add Jyutping transliteration and English translations to the converted Cantonese text.\n- The AI should automatically handle the conversion from standardized Chinese to colloquial Cantonese, adapting vocabulary, grammar structures, and particles to natural Cantonese speech patterns.\n- No prior segmentation is provided; the AI must handle word segmentation.\n- Handle punctuation appropriately (e.g., preserve it in the output without annotation).\n- Use Jyutping system for transliteration (not Pinyin).\n\n### Edge Cases\n- **Empty input**: Return an error message like \"No Chinese text provided.\"\n- **Non-Chinese characters**: Ignore or pass through unchanged (e.g., numbers, English words).\n- **Mixed scripts**: Annotate only Chinese words.\n- **Already in Cantonese**: If input is already in Cantonese colloquial form, proceed directly to annotation without conversion.\n\n## Output Format\n\nThe output is a transformed version of the input text with two stages:\n1. **Converted Cantonese Text**: The standardized Chinese converted to Cantonese colloquial form.\n2. **Annotated Text**: The Cantonese text with Jyutping and English translations.\n\nThe entire output should be a single string or file content, followed by additional sections for grammar analysis.\n\n### 1. Converted Cantonese Text Section\n\n#### Transformation Rule\n- First, automatically convert the standardized Chinese input to natural colloquial Cantonese text.\n- The conversion should adapt the text to natural Cantonese speech patterns, vocabulary, and grammar structures.\n- Preserve the original meaning while making it sound natural in Cantonese.\n\n#### Example\n\n**Input (Standardized Chinese)**: \"你好，我是学生。\"\n\n**Converted Cantonese**: \"你好，我係學生。\"\n\n### 2. Annotated Text Section\n\n#### Transformation Rule (MANDATORY)\n- **This rule MUST be applied to all Chinese text input.**\n- Perform word segmentation on the converted Cantonese text using a reliable method (e.g., via libraries like Jieba with Cantonese support).\n- For each segmented Cantonese word:\n  - Convert the word to Jyutping (using tone numbers, e.g., \"nei5 hou2\" instead of \"nei hou\").\n  - Translate the word to English (provide the most contextually appropriate translation; if ambiguous, choose the primary meaning).\n  - **MUST use the exact format**: `[word in cantonese] ([jyutping] - [english translation])`\n  - Note: Use a **dash/hyphen (-)** between Jyutping and English translation, NOT a comma.\n- Preserve the original order and structure of the text.\n- Non-word elements (e.g., punctuation, spaces) should be retained as-is, without annotations.\n\n#### Markdown Formatting Requirements (MANDATORY)\n- **CRITICAL**: The \"Annotated Text\" section MUST be placed in the main body of the markdown file, NOT inside code blocks (```).\n- **DO NOT** wrap the \"Annotated Text\" section in code block syntax. The annotated text should be rendered as regular markdown paragraphs and headings.\n- **Line Length**: Each line MUST be kept to a maximum of **80-100 characters** (including spaces and punctuation).\n- **Sentence Splitting**: Each sentence MUST be split across multiple lines to ensure medium screen compatibility (768px-1024px width) without requiring a horizontal scrollbar.\n- **Line Breaking**: Break lines at natural points:\n  1. After closing parenthesis `)` of an annotation\n  2. After closing bracket `]` if followed by punctuation\n  3. After punctuation marks (commas `,`, periods `。`, etc.)\n  4. After spaces between annotations\n- **DO NOT** place entire sentences on a single line.\n- See `annotated-text-overflow-wrapping.md` for detailed formatting rules and examples.\n\n#### Formatting Example: WRONG vs CORRECT\n\n**WRONG** - Entire sentence on one line (exceeds 80-100 character limit):\n\n```\n[一名] (jat1 ming4 - one)[44歲] (sei3 sap6 sei3 seoi3 - 44 years old)[男] (naam4 - male)[病人] (beng6 jan2 - patient)[好] (hou2 - very)[急] (gap1 - urgently)[需要] (seoi1 jiu3 - need)[做] (zou6 - do)[心臟] (sam1 zong6 - heart)[移植] (ji4 zik6 - transplant)[手術] (sau2 seot6 - surgery)，\n```\n\n**CORRECT** - Properly split across multiple lines (80-100 characters per line):\n\n```\n[一名] (jat1 ming4 - one)[44歲] (sei3 sap6 sei3 seoi3 - 44 years old)[男] (naam4 - male)\n\n[病人] (beng6 jan2 - patient)[好] (hou2 - very)[急] (gap1 - urgently)\n\n[需要] (seoi1 jiu3 - need)[做] (zou6 - do)[心臟] (sam1 zong6 - heart)[移植] (ji4 zik6 - transplant)\n\n[手術] (sau2 seot6 - surgery)，\n```\n\n**Key Points:**\n- Each line must be 80-100 characters maximum\n- Break lines after closing parentheses `)` of annotations\n- Break lines at natural points (after word groups, before punctuation)\n- Use blank lines between logical groups if needed for readability\n- Never put an entire long sentence on a single line\n\n#### Jyutping Format Guidelines\n- Use tone numbers (1-6) after each syllable (e.g., \"nei5 hou2\").\n- Separate syllables with spaces.\n- Use standard Jyutping romanization system.\n\n#### Example\n\n**Input (Standardized Chinese)**: \"你好，我是学生。\"\n\n**Converted Cantonese**: \"你好，我係學生。\"\n\n**Segmented**: 你好 (nei5 hou2 - hello)，我 (ngo5 - I)係 (hai6 - am)學生 (hok6 saang1 - student)。\n\n**Output Annotated Text** (in main markdown body, NOT in code blocks):\n```markdown\n## Annotated Text:\n\n[你好] (nei5 hou2 - hello)，[我] (ngo5 - I)\n[係] (hai6 - am)[學生] (hok6 saang1 - student)。\n```\n\n**Note**: The example above shows markdown syntax for illustration. In the actual output, this should appear in the main markdown body with proper line breaks (80-100 characters per line), NOT wrapped in code blocks.\n\n### 3. Grammar Patterns Section\n\n#### Rule\n- Analyze the entire converted Cantonese text to identify key grammar patterns used.\n- List each unique pattern with:\n  - A brief description.\n  - Examples from the converted Cantonese text (referencing the annotated version).\n  - Common usage notes specific to Cantonese.\n\n#### Identification Guidelines\n- Use natural language processing techniques to detect Cantonese-specific patterns:\n  - Subject-Verb-Object (SVO) structure.\n  - Use of particles like 嘅 (ge3), 咗 (zo2), 喇 (laa3).\n  - Question formations with 咩 (me1), 呀 (aa3), or sentence-final particles.\n  - Use of 喺 (hai2) for location.\n  - Negative constructions with 唔 (m4) or 冇 (mou5).\n- Limit to 3-5 major patterns per text to avoid overload.\n- If no patterns are detected, state \"No distinct grammar patterns identified.\"\n\n#### Format\nUse a markdown list or table.\n\n#### Visualization Guidelines\n- Keep schemas simple and readable.\n- Label components with Cantonese characters, Jyutping, and English where relevant.\n- If complex, suggest using external tools for full diagrams (but provide basic ones here).\n\n#### Format\nUse markdown code blocks for each schema.\n\n#### Example for SVO Pattern\n\n## Implementation Guidelines for the AI\n\n### Tools and Libraries\n- **Word Segmentation**: Use Jieba with Cantonese support or specialized Cantonese segmentation tools.\n- **Jyutping Conversion**: Use libraries like `pycantonese` or `jyutping` for Python, or equivalent tools for other languages.\n- **Standardized to Cantonese Conversion**: Automatically convert standardized Chinese to colloquial Cantonese using appropriate linguistic knowledge and tools.\n- **Translation**: Use a dictionary-based approach or API (e.g., Google Translate fallback, but prefer offline dict for accuracy).\n- **Grammar Analysis**: Use NLP libraries with Cantonese models or specialized Cantonese NLP tools for pattern detection.\n\n### Error Handling\n- **Invalid Chinese**: \"Input contains invalid characters; please provide valid Chinese text.\"\n- **Long Text**: Limit input to 500 characters; truncate or warn if exceeded.\n- **Conversion Errors**: If a character cannot be converted, preserve the original and note it in the annotation.\n\n### Best Practices\n- Ensure translations are context-aware (e.g., \"hai6\" could be \"係\" (to be) or \"係\" (yes) based on context).\n- Automatically convert standardized Chinese to natural colloquial Cantonese while preserving meaning.\n- Output should be culturally sensitive and reflect natural Cantonese speech patterns.\n- Use appropriate Cantonese particles and grammar structures automatically.\n- Verify Jyutping accuracy using reliable dictionaries or databases.\n- **Formatting**: Always place \"Annotated Text\" section in the main markdown body (not in code blocks).\n- **Line Breaking**: Split sentences across multiple lines (80-100 characters per line) for medium screen compatibility.\n- **Readability**: Break lines at natural points (after annotations, punctuation) to maintain readability.\n\n## Testing Examples\n\n### Input 1: \"今天天气很好。\"\n\n**Expected Output:**\n\n**Converted Cantonese**: \"今日天氣好好。\"\n\n**Annotated Text** (in main markdown body, properly formatted with line breaks):\n```markdown\n## Annotated Text:\n\n[今日] (gam1 jat6 - today)[天氣] (tin1 hei3 - weather)\n[好] (hou2 - very)[好] (hou2 - good)。\n```\n\n**Note**: Each line should be 80-100 characters maximum, and sentences should be split across multiple lines for medium screen compatibility.\n\n\n### Input 2: \"这是我的书。\"\n\n**Expected Output:**\n\n**Converted Cantonese**: \"呢本係我嘅書。\"\n\n**Annotated Text** (in main markdown body, properly formatted with line breaks):\n```markdown\n## Annotated Text:\n\n[呢] (ne1 - this)[本] (bun2 - classifier)\n[係] (hai6 - is)[我] (ngo5 - my)\n[嘅] (ge3 - possessive particle)[書] (syu1 - book)。\n```\n\n**Note**: Each line should be 80-100 characters maximum, and sentences should be split across multiple lines for medium screen compatibility.\n\n",
            "updatedAt": "2025-11-20T14:09:01.377Z"
          },
          "createTime": "2025-11-16T05:26:12.796Z",
          "updateTime": "2025-11-20T14:09:01.399Z"
        },
        {
          "id": "SR6Tp8va8fgLM3wqdP1z",
          "data": {
            "id": "SR6Tp8va8fgLM3wqdP1z",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Web WRITAB",
            "description": "",
            "content": "# API Architecture Overview - AI Agent Context Rules\n\n## Purpose\nThis document provides comprehensive context for AI-driven content generation, code assistance, and system understanding of the WRITAB API. These instructions enable AI agents to accurately generate code, answer queries, and assist with development tasks by understanding the complete system architecture, patterns, and conventions.\n\n---\n\n## Rule - System Overview\nWhen generating code or answering questions about WRITAB API, understand that you are working with:\n\n- **Architecture**: Monorepo (Turborepo) with multiple packages and apps\n- **Primary Technologies**: Node.js, TypeScript, Fastify (HTTP), gRPC (real-time collaboration)\n- **Database**: Supabase (PostgreSQL + Auth)\n- **Storage**: AWS S3 with server-side encryption\n- **Authentication**: Multi-provider (Supabase Auth, Descope Passkeys, GitHub OAuth)\n- **AI Integration**: Grok AI (xAI) for AI-powered features\n- **Deployment**: AWS ECS Fargate with Docker containers\n- **Proxy**: Envoy for gRPC-Web browser compatibility\n\n---\n\n## Rule - Technology Stack Context\n\n### Core Framework\n- **Runtime**: Node.js (LTS 18+)\n- **Language**: TypeScript 5.8.2 with strict mode\n- **HTTP Server**: Fastify ^5.1.0 (high-performance, async/await patterns)\n- **gRPC Server**: @grpc/grpc-js ^1.10.1 (HTTP/2, Protocol Buffers)\n- **Build Tool**: Turborepo for monorepo orchestration\n\n### Key Dependencies\nWhen writing code, use these libraries and their patterns:\n- **Logging**: Pino (JSON structured logs, child loggers)\n- **Validation**: Zod for runtime schema validation\n- **Auth**: JWT with Supabase client, Descope SDK\n- **Database ORM**: Supabase client (async/await, promises)\n- **AWS SDK**: @aws-sdk/client-s3 v3 (modular imports)\n- **HTTP Client**: Native fetch or axios for external APIs\n- **Crypto**: bcryptjs for passwords, otplib for TOTP\n- **Testing**: Jest with TypeScript support\n\n---\n\n## Rule - Project Structure Navigation\n\n### Monorepo Layout\n```\napps/\n  api/                      # Main backend API (focus area)\n    src/\n      app.ts                # Fastify app setup\n      server.ts             # HTTP server entry\n      grpc-server.ts        # gRPC server entry\n      index.ts              # Main orchestrator\n      start-collaboration-server.ts  # Standalone gRPC\n      config/               # Configuration modules\n      controllers/          # HTTP request handlers\n      middleware/           # Auth, validation middleware\n      models/               # Data models/types\n      routes/               # HTTP route definitions\n      services/             # Business logic layer\n      utils/                # Helper functions\n      __tests__/            # Test files\n    supabase/\n      migrations/           # Database migrations\n  frontend/                 # React frontend application\n  proto/                    # gRPC Protocol Buffer definitions\npackages/\n  config-eslint/            # Shared ESLint configs\n  config-typescript/        # Shared TypeScript configs\n  jest-presets/             # Test configurations\n  logger/                   # Logging utilities package\n  ui/                       # Shared React components\ninfrastructure/             # AWS CDK infrastructure code\nbuild/                      # Docker and deployment configs\n```\n\n### Key Files Reference\n- **app.ts**: Fastify app configuration, middleware, route registration\n- **grpc-server.ts**: gRPC service implementation with collaboration logic\n- **config/supabase.ts**: Supabase client initialization\n- **services/**: Business logic (auth, collaboration, GitHub, Grok, S3)\n- **middleware/auth.middleware.ts**: JWT validation, user context injection\n- **routes/**: HTTP endpoint definitions by feature area\n\n---\n\n## Rule - API Endpoints and Patterns\n\n### HTTP API Structure (Fastify)\nBase URL: `/api`\n\n**Authentication Routes** (`/api/auth`):\n- `POST /signup` - User registration with Supabase\n- `POST /signin` - Login with credentials\n- `POST /refresh` - Token refresh\n- `GET /me` - Get authenticated user\n- `POST /mfa/enable` - Enable TOTP MFA\n- `POST /mfa/verify` - Verify TOTP code\n- `POST /passkey/setup` - Initialize passkey registration\n- `POST /passkey/verify` - Verify passkey authentication\n\n**Collaboration Routes** (`/api/collaboration`):\n- `POST /share` - Create document share link\n- `GET /validate-token` - Validate share token\n- `POST /revoke` - Revoke share access\n- `GET /my-shares` - List user's shared documents\n\n**GitHub Routes** (`/api/github`):\n- `GET /repositories` - List user repositories\n- `GET /branches` - List repository branches\n- `GET /commits` - List branch commits\n- `POST /create-branch` - Create new branch\n- Plus additional GitHub operations (files, PRs, etc.)\n\n**Grok AI Routes** (`/api/grok`):\n- `POST /chat` - Chat with Grok AI\n- `POST /analyze` - Analyze content with AI\n- Token usage automatically tracked\n\n**S3 Storage Routes** (`/api/s3`):\n- `POST /upload` - Upload file (multipart/form-data, 50MB limit)\n- `GET /download/:key` - Download file (presigned URL)\n- `DELETE /delete/:key` - Delete file\n- `GET /list` - List user's files\n\n### Response Pattern\nAlways return JSON in this format:\n```typescript\n// Success\n{\n  status: \"success\",\n  data: {...},\n  message?: string\n}\n\n// Error\n{\n  status: \"error\",\n  error: {\n    message: string,\n    code: string,\n    statusCode: number\n  }\n}\n```\n\n---\n\n## Rule - gRPC Service Implementation\n\n### Protocol Definition\nService: `DocumentCollaboration` (document-collaboration.proto)\n\n**RPC Methods**:\n1. **JoinDocument** (Unary): Join collaboration session with role (owner/viewer)\n2. **SendOperation** (Unary): Send document edit operations (owner only)\n3. **LeaveDocument** (Unary): Leave collaboration session\n4. **SubscribeToDocument** (Server Streaming): Receive real-time document updates\n\n### Implementation Patterns\nWhen implementing gRPC services:\n- Use `Map<string, T>` for session and subscriber tracking\n- Implement role-based access control (owner can edit, viewer can only read)\n- Assign server-side sequence numbers to all operations\n- Broadcast operations to all subscribers of a document\n- Clean up sessions and streams on disconnect/leave\n- Send heartbeat messages every 30 seconds\n- Handle errors gracefully with gRPC status codes\n\n### Connection Management\n- **Session ID**: Generated UUID for each user-document connection\n- **Document ID**: Unique identifier for collaboration context\n- **Subscribers**: Map of document IDs to streaming connections\n- **Sequence Numbers**: Monotonically increasing per document\n\n---\n\n## Rule - Authentication Implementation\n\n### Multi-Provider Auth Pattern\nSupport three authentication flows:\n\n**1. Supabase Auth (Primary)**:\n```typescript\n// Signup\nsupabase.auth.signUp({ email, password })\n// Login\nsupabase.auth.signInWithPassword({ email, password })\n// Validate\nsupabase.auth.getUser(jwt)\n```\n\n**2. Passkey Auth (Descope)**:\n```typescript\n// Setup\ndescopeClient.management.user.createPasskey(userId)\n// Verify\ndescopeClient.validateJwt(descopeToken)\n```\n\n**3. GitHub OAuth**:\n```typescript\n// Exchange code for token\nPOST https://github.com/login/oauth/access_token\n// Store encrypted in database\n```\n\n### JWT Token Structure\n```typescript\ninterface JWTPayload {\n  userId: string;\n  email: string;\n  role?: string;\n  iat: number;\n  exp: number;\n}\n```\n\n### Middleware Pattern\n```typescript\n// Extract token from Authorization header\nconst token = request.headers.authorization?.split(' ')[1];\n// Verify JWT\nconst decoded = jwt.verify(token, process.env.JWT_SECRET);\n// Inject user into request\nrequest.user = decoded;\n```\n\n---\n\n## Rule - Database Schema Context (Supabase)\n\n### Core Tables (Schema: `api`)\nWhen querying or inserting data, use these tables:\n\n**profiles**:\n- id (uuid, PK, references auth.users)\n- email (text)\n- username (text)\n- full_name (text)\n- mfa_enabled (boolean)\n- mfa_secret (text, encrypted)\n- created_at, updated_at\n\n**backup_codes**:\n- id (uuid, PK)\n- user_id (uuid, FK to profiles)\n- code_hash (text)\n- used (boolean)\n- created_at\n\n**passkeys**:\n- id (uuid, PK)\n- user_id (uuid, FK to profiles)\n- credential_id (text, unique)\n- public_key (text)\n- counter (integer)\n- created_at\n\n**document_shares**:\n- id (uuid, PK)\n- document_id (text)\n- owner_id (uuid, FK to profiles)\n- share_token (text, unique)\n- expires_at (timestamp)\n- access_level (text: 'view'|'edit')\n- created_at\n\n**s3_storage**:\n- id (uuid, PK)\n- user_id (uuid, FK to profiles)\n- file_key (text)\n- file_name (text)\n- file_size (bigint)\n- content_type (text)\n- uploaded_at\n\n**ai_usage_logs**:\n- id (uuid, PK)\n- user_id (uuid, FK to profiles)\n- prompt_tokens (integer)\n- completion_tokens (integer)\n- total_tokens (integer)\n- created_at\n\n### Query Patterns\nAlways use async/await with Supabase client:\n```typescript\nconst { data, error } = await supabase\n  .from('profiles')\n  .select('*')\n  .eq('id', userId)\n  .single();\n```\n\n---\n\n## Rule - External Service Integration\n\n### AWS S3 Operations\n**Configuration**:\n- Bucket: `process.env.AWS_S3_BUCKET`\n- Region: `process.env.AWS_REGION`\n- Encryption: AES256 (server-side)\n- Key Pattern: `user-{userId}/{filename}`\n\n**Upload Pattern**:\n```typescript\nimport { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';\nconst command = new PutObjectCommand({\n  Bucket: bucket,\n  Key: `user-${userId}/${filename}`,\n  Body: fileBuffer,\n  ContentType: contentType,\n  ServerSideEncryption: 'AES256',\n  BucketKeyEnabled: true\n});\nawait s3Client.send(command);\n```\n\n### GitHub API Integration\n**Authentication**: OAuth tokens stored encrypted in database\n**Base URL**: `https://api.github.com`\n**Headers**: \n```typescript\n{\n  'Authorization': `Bearer ${githubToken}`,\n  'Accept': 'application/vnd.github.v3+json',\n  'User-Agent': 'WRITAB-API'\n}\n```\n\n### Grok AI (xAI)\n**Model**: `grok-beta`\n**Endpoint**: `https://api.x.ai/v1/chat/completions`\n**Pattern**:\n```typescript\nconst response = await fetch('https://api.x.ai/v1/chat/completions', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${process.env.GROK_API_KEY}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    model: 'grok-beta',\n    messages: [{ role: 'user', content: prompt }]\n  })\n});\n// Track token usage in database\n```\n\n---\n\n## Rule - Environment Variables\n\n### Required Variables\nWhen generating code or configurations, expect these environment variables:\n\n**Core**:\n- `NODE_ENV`: production|development|test\n- `PORT`: HTTP server port (default: 3000)\n- `GRPC_PORT`: gRPC server port (default: 50051)\n- `LOG_LEVEL`: info|debug|warn|error\n- `JWT_SECRET`: Min 32 characters for signing tokens\n\n**Database & Auth**:\n- `SUPABASE_URL`: Supabase project URL\n- `SUPABASE_ANON_KEY`: Supabase anonymous key\n- `DESCOPE_PROJECT_ID`: Descope project identifier\n\n**External Services**:\n- `GITHUB_CLIENT_ID`: GitHub OAuth app ID\n- `GITHUB_CLIENT_SECRET`: GitHub OAuth secret\n- `GROK_API_KEY`: xAI Grok API key\n- `AWS_REGION`: AWS region (e.g., us-east-1)\n- `AWS_S3_BUCKET`: S3 bucket name\n\n**Optional**:\n- `REDIS_ENABLED`: true|false (default: false)\n- `REDIS_URL`: Redis connection string\n- `SWAGGER_USERNAME`: API docs basic auth username\n- `SWAGGER_PASSWORD`: API docs basic auth password\n- `FRONTEND_URL`: Frontend application URL for CORS\n\n---\n\n## Rule - Error Handling Patterns\n\n// Server error\nreply.code(500).send({\n  status: 'error',\n  error: {\n    message: 'Internal server error',\n    code: 'INTERNAL_ERROR',\n    statusCode: 500\n  }\n});\n```\n\n### gRPC Error Handling\nUse gRPC status codes:\n```typescript\nimport * as grpc from '@grpc/grpc-js';\n\n// Permission denied\ncallback({\n  code: grpc.status.PERMISSION_DENIED,\n  message: 'Only owner can send operations'\n});\n\n// Not found\ncallback({\n  code: grpc.status.NOT_FOUND,\n  message: 'Document not found'\n});\n\n// Internal error\ncallback({\n  code: grpc.status.INTERNAL,\n  message: 'Server error occurred'\n});\n```\n---\n\n## Rule - Testing Patterns\n\n### Test Structure\n```typescript\nimport { createApp } from '../app';\nimport request from 'supertest';\n\ndescribe('Feature Tests', () => {\n  let app;\n  \n  beforeAll(async () => {\n    app = await createApp();\n  });\n  \n  afterAll(async () => {\n    await app.close();\n  });\n  \n  it('should test endpoint', async () => {\n    const response = await request(app.server)\n      .post('/api/endpoint')\n      .send({ data: 'test' })\n      .expect(200);\n    \n    expect(response.body.status).toBe('success');\n  });\n});\n```\n\n### gRPC Testing\n```typescript\nimport * as grpc from '@grpc/grpc-js';\nimport * as protoLoader from '@grpc/proto-loader';\n\n// Load proto\nconst packageDefinition = protoLoader.loadSync('path/to/proto');\nconst proto = grpc.loadPackageDefinition(packageDefinition);\n\n// Create client\nconst client = new proto.service.ServiceName(\n  'localhost:50051',\n  grpc.credentials.createInsecure()\n);\n\n// Test RPC\nclient.methodName(request, (error, response) => {\n  expect(error).toBeNull();\n  expect(response).toBeDefined();\n});\n```\n\n---\n\n## Rule - Docker and Deployment\n\n### Container Configuration\n**API Dockerfile** (multi-stage build):\n- Base: node:18-alpine\n- Development: Hot reload with volume mounts\n- Production: Optimized build, minimal layers\n\n**Envoy Proxy**: gRPC-Web gateway on port 8080\n\n**Docker Compose** (Development):\n```yaml\nservices:\n  api:\n    ports: [\"4000:3000\", \"50051:50051\"]\n    volumes: [\".:/app\"]\n  envoy:\n    ports: [\"8080:8080\", \"9901:9901\"]\n```\n\n### AWS Infrastructure (CDK)\n**Bootstrap Stack**: ECR, S3, VPC, IAM roles\n**Compute Stack**: ECS Fargate, ALB, auto-scaling\n\n**Deployment Commands**:\n- `npm run docker:dev` - Start development containers\n- `scripts/deploy-bootstrap-only.sh` - Deploy infrastructure\n- `scripts/deploy-compute-only.sh` - Deploy application\n- `scripts/build-and-push.sh` - Build and push images to ECR\n\n\n## Summary - AI Agent Context\n\nThis document provides comprehensive context for AI agents assisting with WRITAB API development. When generating code, answering questions, or providing guidance:\n\n1. **Follow the established patterns** documented in these rules\n2. **Use the specified technology stack** and libraries\n3. **Adhere to security best practices** for authentication, validation, and data handling\n4. **Structure code** according to the monorepo layout and conventions\n5. **Implement proper error handling** with consistent response formats\n6. **Write tests** following the established testing patterns\n7. **Log appropriately** using structured logging with Pino\n8. **Consider deployment context** with Docker and AWS infrastructure\n\nThese rules create a comprehensive context that enables accurate, consistent, and production-ready code generation aligned with the existing architecture and patterns.\n\n\n**Purpose**: AI Agent Context for Code Generation and System Understanding\n",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt",
              "quiz",
              "followup"
            ],
            "isDefault": true,
            "createdAt": "2025-11-22T05:40:14.211Z",
            "directoryIds": [
              "OOdhTK912YEo6Psfm5Tg"
            ],
            "updatedAt": "2025-11-22T05:41:03.246Z"
          },
          "createTime": "2025-11-22T05:40:14.248Z",
          "updateTime": "2025-11-22T05:41:03.265Z"
        },
        {
          "id": "Skn63x5Isj1q0ZICsIVM",
          "data": {
            "id": "Skn63x5Isj1q0ZICsIVM",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "description": "",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt"
            ],
            "isDefault": true,
            "createdAt": "2025-11-20T13:52:48.226Z",
            "directoryIds": [
              "raI9erLcbUR3h35N5kD1"
            ],
            "name": "Text Transform Overflow",
            "content": "# Annotated Text Overflow and Wrapping Rules for AI Agents\n\n## IMPORTANT: This is a MANDATORY Markdown Formatting Rule\n\n**This document defines mandatory markdown formatting rules that AI agents MUST follow when generating \"Annotated Text\" sections in markdown files. The goal is to prevent horizontal overflow and ensure text wraps properly when the markdown is rendered. Each sentence MUST be split appropriately so that the content can be displayed on medium-sized screens without requiring a horizontal scrollbar.**\n\n## Problem Statement\n\nWhen AI agents generate markdown files containing \"Annotated Text\" sections with Cantonese annotations in the format:\n```\n[word in cantonese] ([jyutping] - [english translation])\n```\n\nIf these annotations are placed on extremely long lines without proper line breaks, the rendered markdown will overflow the container's right border, causing horizontal scrolling and poor user experience. **Each sentence MUST be split into multiple lines so that the content fits within medium-sized screen widths (typically 768px-1024px) without requiring a horizontal scrollbar.**\n\n## Visual Problem: WRONG SCENARIO\n\n```\n┌─────────────────────────────────────────────────────────────────────────┐\n│ Annotated Text:                                                          │\n│                                                                           │\n│ [醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)[今日](gam1 jat6 - today)(20[日](jat6 - day) measure word) [44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive particle) [有](jau5 - have)[個](go3 - measure word) [44歲](sei3 sap6 sei3 seoi3 - 44 years old)[嘅](ge3 - possessive particle) [佢] (keoi5 - he)[喺](hai2 - at)[東涌] (dung1 cung1 – Tung Chung)[天主教](tin1 zyu2 gaau3 - Catholic) [有](jau5 - have)[兩個](loeng5 go3 - two)[細路女] (sai3 lou6 neoi2 young daughters), [自從](zi6 cung4 since)[10月](sap6 jyut6 October) [20號] (ji6 sap6 hou6 20th)[做完](zou6 jyun4 after doing)[手術] (sau2 seot6 surgery)[之後](zi1 hau6 after) [一路](jat1 lou6 – continuously)[喺](hai2 - at)[深切治療部](sam1 cit3 zi6 liu4 bou6 intensive care unit) [仲](zung6 even)[試過](si3 gwo3 - experienced)[肺衰竭](fai3 seoi1 kit3 lung failure), [要](jiu3 need)[靠](kaau3 rely on)[人工肺](jan4 gung1 fai3 artificial lung)[呼吸](fu1 kap1 breathe) [而家](ji4 ga1 - now)[喺](hai2 - at)[換心臟](wun6 sam1 zong6 heart transplant)[嘅](ge3 possessive particle) [所以] (so2 ji5 - so)[想](soeng2 - want)[問下](man6 haa5 - ask)[大家](daai6 gaa1 – everyone), [如果](yju4 gwo2 if)[親人](can1 jan4 relatives)[過咗身](gwo3 zo2 san1 passed away), [可唔可以](ho2 m4 ho2 ji5 can or cannot)[考慮](haau2 leoi6 consider)[捐](gyun1 donate)[心臟](sam1 zong6 heart) [幫](bong1 help)[人](jan4 - people), [延續] (jin4 zuk6 continue) [大愛] (daai6 oi3 great love)。 │\n│                                                                           │\n│ ←───────────────────────────────────────────────────────────────────────→│\n│                    HORIZONTAL SCROLLBAR APPEARS HERE                      │\n└─────────────────────────────────────────────────────────────────────────┘\n```\n\n**Problems:**\n- ❌ Single extremely long line without breaks\n- ❌ Text extends beyond container width\n- ❌ Horizontal scrollbar required to read content\n- ❌ Poor user experience\n- ❌ Content overflows right border\n\n## Visual Solution: CORRECT SCENARIO\n\n```\n┌─────────────────────────────────────────────────────────────────────────┐\n│ Annotated Text:                                                          │\n│                                                                           │\n│ [醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)         │\n│ [今日](gam1 jat6 - today)(20[日](jat6 - day) measure word)              │\n│ [44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive          │\n│ particle) [有](jau5 - have)[個](go3 - measure word)                    │\n│ [44歲](sei3 sap6 sei3 seoi3 - 44 years old)[嘅](ge3 - possessive        │\n│ particle) [佢] (keoi5 - he)[喺](hai2 - at)[東涌]                        │\n│ (dung1 cung1 – Tung Chung)[天主教](tin1 zyu2 gaau3 - Catholic)          │\n│ [有](jau5 - have)[兩個](loeng5 go3 - two)[細路女]                        │\n│ (sai3 lou6 neoi2 young daughters), [自從](zi6 cung4 since)              │\n│ [10月](sap6 jyut6 October) [20號] (ji6 sap6 hou6 20th)                  │\n│ [做完](zou6 jyun4 after doing)[手術] (sau2 seot6 surgery)                │\n│ [之後](zi1 hau6 after) [一路](jat1 lou6 – continuously)                  │\n│ [喺](hai2 - at)[深切治療部](sam1 cit3 zi6 liu4 bou6 intensive            │\n│ care unit) [仲](zung6 even)[試過](si3 gwo3 - experienced)                │\n│ [肺衰竭](fai3 seoi1 kit3 lung failure), [要](jiu3 need)                  │\n│ [靠](kaau3 rely on)[人工肺](jan4 gung1 fai3 artificial lung)            │\n│ [呼吸](fu1 kap1 breathe) [而家](ji4 ga1 - now)[喺](hai2 - at)            │\n│ [換心臟](wun6 sam1 zong6 heart transplant)[嘅](ge3 possessive            │\n│ particle) [所以] (so2 ji5 - so)[想](soeng2 - want)                      │\n│ [問下](man6 haa5 - ask)[大家](daai6 gaa1 – everyone),                   │\n│ [如果](yju4 gwo2 if)[親人](can1 jan4 relatives)                          │\n│ [過咗身](gwo3 zo2 san1 passed away), [可唔可以](ho2 m4 ho2 ji5            │\n│ can or cannot)[考慮](haau2 leoi6 consider)[捐](gyun1 donate)               │\n│ [心臟](sam1 zong6 heart) [幫](bong1 help)[人](jan4 - people),            │\n│ [延續] (jin4 zuk6 continue) [大愛] (daai6 oi3 great love)。              │\n│                                                                           │\n│ ✅ All text fits within container                                        │\n│ ✅ No horizontal scrollbar needed                                         │\n│ ✅ Text wraps naturally                                                  │\n└─────────────────────────────────────────────────────────────────────────┘\n```\n\n**Solutions:**\n- ✅ Text broken into multiple lines\n- ✅ Each line fits within container width\n- ✅ No horizontal scrolling required\n- ✅ Better readability\n- ✅ Content stays within borders\n\n## Mandatory Formatting Rules for AI Agents\n\n### Rule 0: Annotated Text Must Be in Main Markdown Body (NOT in Code Blocks)\n\n**CRITICAL**: The \"Annotated Text\" section MUST be placed in the main body of the markdown file, NOT inside code blocks (```).\n\n**DO NOT** wrap the \"Annotated Text\" section in code block syntax. The annotated text should be rendered as regular markdown paragraphs and headings, allowing the markdown renderer to properly format and wrap the text.\n\n**Example - CORRECT (in main markdown body):**\n```markdown\n## Annotated Text:\n\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)\n[今日](gam1 jat6 - today)(20[日](jat6 - day) measure word)\n[44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive particle)\n```\n\n**Example - WRONG (inside code block):**\n```markdown\n## Annotated Text:\n\n```\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)\n[今日](gam1 jat6 - today)(20[日](jat6 - day) measure word)\n[44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive particle)\n```\n```\n\n**Rationale**: \n- Code blocks prevent proper text wrapping and line breaking\n- Code blocks are displayed with monospace fonts and fixed-width formatting\n- The \"Annotated Text\" section needs to be rendered as regular markdown text to benefit from automatic wrapping and responsive layout\n- Placing it in code blocks defeats the purpose of proper line breaking and medium screen compatibility\n\n### Rule 1: Maximum Line Length and Medium Screen Compatibility\n\n**MUST**: Keep each line in the \"Annotated Text\" section to a maximum of **80-100 characters** (including spaces and punctuation).\n\n**CRITICAL**: Each sentence MUST be split across multiple lines to ensure the content can be displayed on medium-sized screens (768px-1024px width) without requiring a horizontal scrollbar. Do NOT place entire sentences on a single line.\n\n**Rationale**: \n- Most markdown renderers display content in containers that are 80-100 characters wide\n- Medium-sized screens typically have viewport widths of 768px-1024px\n- Longer lines will overflow and require horizontal scrolling, which degrades user experience\n- Sentences should be broken at natural points to fit within these constraints\n\n### Rule 2: Break After Complete Annotations\n\n**MUST**: Break lines after complete annotation units. A complete annotation unit is:\n```\n[word] (jyutping - translation)\n```\n\n**DO NOT** break in the middle of an annotation. Break AFTER the closing parenthesis `)`.\n\n**Example - CORRECT:**\n```markdown\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)\n[今日](gam1 jat6 - today)\n```\n\n**Example - WRONG:**\n```markdown\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)[今日](gam1 jat6 - tod\nay)\n```\n\n### Rule 3: Break at Natural Points\n\n**MUST**: Break lines at these natural points (in order of preference):\n1. After closing parenthesis `)` of an annotation\n2. After closing bracket `]` if followed by punctuation\n3. After punctuation marks (commas `,`, periods `。`, etc.)\n4. After spaces between annotations\n\n**Example - CORRECT:**\n```markdown\n[醫院](ji1 yun2 – hospital)，[管理局](gun2 lei5 guk6 – authority)。\n[今日](gam1 jat6 - today)\n```\n\n### Rule 4: Preserve Annotation Format\n\n**MUST**: Always preserve the exact annotation format:\n- `[word]` - Chinese characters in square brackets\n- `(jyutping - translation)` - Jyutping and translation in parentheses\n- Maintain spacing and punctuation exactly as specified\n\n**DO NOT** modify the annotation format when breaking lines.\n\n### Rule 5: Sentence Splitting for Medium Screen Compatibility\n\n**MUST**: Split each sentence across multiple lines to ensure medium screen compatibility:\n- **Each sentence MUST be broken into multiple lines** - Never place an entire sentence on a single line\n- Break sentences at natural points (after annotations, punctuation, etc.)\n- Ensure each line segment fits within 80-100 characters\n- The goal is to display content on medium screens (768px-1024px) without horizontal scrolling\n\n**Example - CORRECT (sentence split across multiple lines):**\n```markdown\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)\n[今日](gam1 jat6 - today)(20[日](jat6 - day) measure word)\n[44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive particle)\n```\n\n**Example - WRONG (entire sentence on one line):**\n```markdown\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)[今日](gam1 jat6 - today)(20[日](jat6 - day) measure word) [44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive particle)\n```\n\n### Rule 6: Paragraph Structure\n\n**MUST**: Use proper markdown paragraph structure:\n- Each paragraph should be separated by blank lines\n- Long paragraphs should be broken into multiple lines\n- Maintain consistent line breaks within the same paragraph\n- Apply sentence splitting rules within each paragraph\n\n**Example - CORRECT:**\n```markdown\n## Annotated Text:\n\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)\n[今日](gam1 jat6 - today)(20[日](jat6 - day) measure word)\n[44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive particle)\n```\n\n## Implementation Guidelines for AI Agents\n\n### Step-by-Step Process\n\n1. **Generate the annotated text** with all annotations in the correct format\n2. **Place in main markdown body** - Ensure the \"Annotated Text\" section is NOT inside code blocks (```)\n3. **Identify sentence boundaries** - Locate where sentences end (punctuation marks like `。`, `,`, etc.)\n4. **Split each sentence** - Break each sentence into multiple lines (DO NOT keep entire sentences on one line)\n5. **Calculate line length** - Count characters including spaces for each line segment\n6. **Break at 80-100 characters** - Insert line breaks at natural points within sentences\n7. **Verify medium screen compatibility** - Ensure content fits on 768px-1024px screens without horizontal scrollbar\n8. **Preserve format** - Maintain annotation structure exactly\n\n### Algorithm for Line Breaking\n\n```\nFOR each sentence in the annotated text:\n  FOR each annotation in the current sentence:\n    IF current line length + annotation length > 80 characters:\n      BREAK line after previous complete annotation\n      START new line with current annotation\n    ELSE:\n      ADD annotation to current line\n    END IF\n  END FOR\n  // Ensure sentence is split across multiple lines (not all on one line)\n  IF sentence spans only one line AND line length > 80 characters:\n    SPLIT sentence at natural break points\n  END IF\nEND FOR\n```\n\n### Example Transformation\n\n**Note**: The examples below show markdown syntax for illustration. In the actual generated markdown file, the \"Annotated Text\" section should be placed in the main markdown body (with a heading like `## Annotated Text:`), NOT wrapped in code blocks.\n\n**Input (from AI transformation - single long line):**\n```markdown\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)[今日](gam1 jat6 - today)(20[日](jat6 - day) measure word) [44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive particle) [有](jau5 - have)[個](go3 - measure word) [44歲](sei3 sap6 sei3 seoi3 - 44 years old)[嘅](ge3 - possessive particle) [佢] (keoi5 - he)[喺](hai2 - at)[東涌] (dung1 cung1 – Tung Chung)[天主教](tin1 zyu2 gaau3 - Catholic)\n```\n\n**Output (after applying line breaking rules - in main markdown body):**\n```markdown\n## Annotated Text:\n\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)\n[今日](gam1 jat6 - today)(20[日](jat6 - day) measure word)\n[44歲](sei3 sap6 sei3 seoi3 44 years old)[嘅](ge3 - possessive particle)\n[有](jau5 - have)[個](go3 - measure word)\n[44歲](sei3 sap6 sei3 seoi3 - 44 years old)[嘅](ge3 - possessive particle)\n[佢] (keoi5 - he)[喺](hai2 - at)[東涌] (dung1 cung1 – Tung Chung)\n[天主教](tin1 zyu2 gaau3 - Catholic)\n```\n\n**Important**: The output above shows the content that should appear in the main markdown body. Do NOT wrap this section in code blocks (```).\n\n## Edge Cases\n\n### Very Long Single Annotations\n\nIf a single annotation is extremely long (e.g., `[非常長的詞語](fei1 soeng4 zeng1 dik1 ci4 jyu5 - very long word)`), it may still overflow. In this case:\n\n1. **Prefer**: Keep it on its own line\n2. **If still too long**: Break after the closing bracket `]` but before the opening parenthesis `(`\n3. **Last resort**: Break within the translation, but preserve the format\n\n**Example:**\n```markdown\n[非常長的詞語]\n(fei1 soeng4 zeng1 dik1 ci4 jyu5 - very long word)\n```\n\n### Mixed Content\n\nIf paragraphs contain both annotated text and regular text:\n\n1. Break annotated sections according to rules above\n2. Keep regular text on separate lines if needed\n3. Maintain paragraph structure\n\n**Example:**\n```markdown\nThis is regular text.\n\n[醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)\n[今日](gam1 jat6 - today)\n\nMore regular text here.\n```\n\n### Lists and Nested Structures\n\nIf annotated text appears in lists:\n\n1. Apply line breaking rules within each list item\n2. Maintain list item indentation\n3. Break lines appropriately\n\n**Example:**\n```markdown\n- [醫院](ji1 yun2 – hospital)[管理局](gun2 lei5 guk6 – authority)\n- [今日](gam1 jat6 - today)(20[日](jat6 - day) measure word)\n```\n\n## Testing Checklist for AI Agents\n\n",
            "updatedAt": "2025-11-20T14:04:48.120Z"
          },
          "createTime": "2025-11-20T13:52:48.252Z",
          "updateTime": "2025-11-20T14:04:48.142Z"
        },
        {
          "id": "V5ZdzRuGbAsVgsed9saP",
          "data": {
            "id": "V5ZdzRuGbAsVgsed9saP",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "DSA  Doc",
            "description": "",
            "content": "You are a technical documentation expert with deep knowledge across various technical domains. Your task is to generate comprehensive, well-structured documentation based on user prompts.\n\n**CONTENT REQUIREMENTS:**\n\n1. **Minimum Length**: 1000 words (excluding diagrams and tables)\n2. **Tables**: Include 1-2 well-formatted markdown tables that are contextually relevant\n   - Use tables to compare features, list specifications, show relationships, etc.\n   - Ensure tables are properly formatted with headers and alignment\n   - Tables should add value and clarity to the content\n3. **ASCII Diagrams**: Include 2-3 ASCII diagrams in code blocks\n   - Choose diagram types based on content (flowcharts, architecture, relationships, processes, etc.)\n   - Diagrams should illustrate key concepts visually\n   - Use box drawing characters and symbols for clarity\n4. **Code Examples**: Include code examples if relevant to the topic\n   - Use appropriate language syntax highlighting\n   - Add comments to explain complex parts\n   - Ensure code is practical and runnable\n5. **Depth**: Provide detailed explanations with technical accuracy\n6. **Clarity**: Write in clear, professional technical writing style\n\n\n**REQUIRED DOCUMENT STRUCTURE:**\n\nYour document MUST follow this structure:\n\n# [Document Title]\n*Generate an appropriate, descriptive title based on the user's prompt*\n\n## Glossary\n- Define key terms and concepts that will be used throughout the document\n- Include 5-10 essential terms with clear, concise definitions\n- Format as a list or table for easy reference\n\n## Core Concepts\n- Provide comprehensive explanations of the fundamental concepts\n- Break down complex ideas into digestible sections\n- Use subsections (###) to organize different aspects\n- Include real-world context and applications\n- This should be the most substantial section (400-600 words)\n\n## Examples\n- Provide practical, concrete examples that demonstrate the concepts\n- Include code snippets if applicable (with proper syntax highlighting)\n- Use realistic scenarios that readers can relate to\n- Show both simple and complex use cases\n- Explain each example thoroughly (200-400 words)\n\n## Summary\n- Recap the key takeaways from the document\n- Highlight the most important points\n- Provide actionable insights or next steps\n- Keep it concise but comprehensive (100-200 words)\n\n**MARKDOWN FORMATTING GUIDELINES:**\n\n1. **Headers**:\n   - Use # for main title\n   - Use ## for major sections (Glossary, Core Concepts, Examples, Summary)\n   - Use ### for subsections within major sections\n   - Use #### for sub-subsections if needed\n\n2. **Emphasis**:\n   - Use **bold** for important terms and concepts\n   - Use *italics* for emphasis and technical terms\n   - Use \\`inline code\\` for code references, commands, and technical identifiers\n\n3. **Lists**:\n   - Use bullet points (-) for unordered lists\n   - Use numbers (1., 2., 3.) for sequential steps or ordered information\n   - Indent nested lists properly\n\n4. **Code Blocks**:\n   - Use triple backticks with language identifier: \\`\\`\\`javascript, \\`\\`\\`python, etc.\n   - Include comments in code to explain functionality\n   - Keep code examples concise but complete\n\n5. **Tables**:\n   - Use proper markdown table syntax with pipes (|) and hyphens (-)\n   - Align columns using colons (:---, :---:, ---:)\n   - Include clear headers\n   - Example:\n   \\`\\`\\`\n   | Feature | Description | Use Case |\n   |---------|-------------|----------|\n   | Item 1  | Details...  | When...  |\n   | Item 2  | Details...  | When...  |\n   \\`\\`\\`\n\n6. **Links and References**:\n   - Use inline links: [text](url)\n   - Reference related concepts within the document\n   \n   \n**CRITICAL OUTPUT REQUIREMENTS:**\n\n1. **Pure Markdown**: Output ONLY markdown content\n   - NO wrapper code blocks (don't wrap the entire document in \\`\\`\\`markdown)\n   - NO additional commentary or meta-text\n   - Start directly with the document title\n\n2. **Content Validation**:\n   - Ensure the document has at least 1000 words (excluding tables and diagrams)\n   - Verify all 4 required sections are present and properly formatted\n   - Confirm 1-2 tables are included and properly formatted\n   - Confirm 2-3 ASCII diagrams are included in code blocks\n   - Check that all markdown syntax is correct\n\n3. **Quality Standards**:\n   - Write in professional technical documentation style\n   - Use accurate technical information\n   - Provide practical, actionable insights\n   - Ensure content directly addresses the user's prompt\n   - Make the document comprehensive but accessible\n\n4. **Structure Compliance**:\n   - Follow the exact section structure: Glossary → Core Concepts → Examples → Summary\n   - Use proper heading levels\n   - Maintain consistent formatting throughout\n\n",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt"
            ],
            "isDefault": true,
            "createdAt": "2025-11-16T04:56:08.834Z",
            "directoryIds": [
              "B0vn5dW2CtxFrhFimGy5",
              "NRRUgXu8X6kqDUZ2uDNH"
            ],
            "updatedAt": "2026-01-18T03:44:22.278Z"
          },
          "createTime": "2025-11-16T04:56:08.860Z",
          "updateTime": "2026-01-18T03:44:22.320Z"
        },
        {
          "id": "Vvcf5TSNpd6daNWoPAOH",
          "data": {
            "id": "Vvcf5TSNpd6daNWoPAOH",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Web Panther",
            "description": "",
            "content": "---\napplyTo: '**'\n---\n\n# GitHub Copilot Instructions for Package Panther\n\n## Project Overview\n\nThis is a React web application built with TypeScript, Tailwind CSS v4, React Router v7, Redux Toolkit, RTK Query, and modern React patterns.\n\n**For detailed, domain-specific guidance, refer to these modular instruction files:**\n- **API & RTK Query**: See `.github/instructions/api-patterns.instructions.md`\n- **Component Structure**: See `.github/instructions/component-structure.instructions.md`\n- **Form Handling**: See `.github/instructions/form-handling.instructions.md`\n- **Styling & Theme**: See `.github/instructions/styling.instructions.md`\n\n## Technology Stack\n\n- **Build Tool**: Vite\n- **Package Manager**: Yarn (use `--ignore-engines` flag for compatibility issues)\n- **Framework**: React 19+ with TypeScript\n- **UI Library**: Custom components only (no external UI libraries)\n- **Styling**: Tailwind CSS v4 with `@theme` directive and CSS custom properties\n- **Routing**: React Router v7\n- **State Management**: Redux Toolkit with RTK Query\n- **API Client**: RTK Query with fetchBaseQuery (native Fetch API)\n- **Authentication**: Token-based with X-API-Token header\n- **Icons**: Custom SVG icons and Radix UI icons\n- **Form Handling**: React Hook Form with Zod validation\n- **Notifications**: React hot toast for user feedback\n\n## Code Style and Structure\n\n- Write concise, technical TypeScript code with accurate examples\n- Use functional and declarative programming patterns; avoid classes\n- Prefer iteration and modularization over code duplication\n- Use descriptive variable names with auxiliary verbs (e.g., isLoading, hasError)\n- Structure files: exported component, subcomponents, helpers, static content, types\n- Follow React Router v7 Documentation for routing and navigation\n- Favor named exports for components\n- Use TypeScript for all code; prefer interfaces over types\n- **Always use absolute paths for imports** - Never use relative paths (e.g., use `api/Shipments` instead of `../../../api/Shipments`)\n\n## Dependency Management\n\n### Installing Dependencies\n\nWhen adding new dependencies to the project, use Yarn:\n\n```bash\n# Install production dependencies\nyarn add react react-dom @reduxjs/toolkit react-redux\n\n# Install development dependencies\nyarn add -D @types/react @types/react-dom typescript\n\n# Use --ignore-engines flag if there are Node.js version compatibility issues\nyarn add some-package --ignore-engines\n\n# Remove dependencies\nyarn remove package-name\n```\n\n**Important**: Use `--ignore-engines` flag when encountering Node.js version compatibility issues with some packages.\n\n### Key Dependencies\n\n#### UI & Styling\n- `clsx` - Conditional className utility\n- `tailwind-merge` - Tailwind class merging utility\n- `tw-animate-css` - Animation utilities for Tailwind CSS\n- `class-variance-authority` - Component variant management\n\n#### State Management & API\n- `@reduxjs/toolkit` - Redux state management with RTK Query\n- `react-redux` - React bindings for Redux\n- `redux-persist` - Persist Redux state to localStorage\n\n#### Notifications & Feedback\n- `react-hot-toast` - Toast notifications for user feedback\n\n#### Routing & Core\n- `react-router-dom` - Client-side routing\n- `react` & `react-dom` - React framework\n\n## TypeScript Guidelines\n\n- Use interfaces for all component props and data structures\n- Define proper types for all functions and variables\n- Use generic types where appropriate\n- Leverage TypeScript's strict mode features\n- **Use inline interfaces in component files** - Define interfaces directly in `.tsx` files instead of separate `.ts` files\n- **Never create empty interfaces** - Use `Record<string, never>` type or omit props parameter if component doesn't need props\n\n## Navigation and Routing with React Router v7\n\n### Protected Routes Pattern\n\nAll routes except `/auth` should be protected:\n\n```typescript\n// utils/ProtectedRoute.tsx\nimport { Navigate, useLocation } from \"react-router\";\nimport { useSelector } from \"react-redux\";\nimport { selectIsAuthenticated } from \"../store/slices/authSlice\";\n\ninterface IProtectedRoute {\n  children: React.ReactNode;\n}\n\nexport const ProtectedRoute = ({ children }: IProtectedRoute) => {\n  const isAuthenticated = useSelector(selectIsAuthenticated);\n  const location = useLocation();\n\n  if (!isAuthenticated) {\n    return <Navigate to=\"/auth\" state={{ from: location }} replace />;\n  }\n\n  return <>{children}</>;\n};\n```\n\n### Route Configuration\n\n```typescript\n// routes.tsx\nimport { type RouteConfig, route, index } from \"@react-router/dev/routes\";\n\nexport default [\n  index(\"./app.tsx\"),\n  route(\"auth\", \"./pages/AuthPage/AuthPage.tsx\"),\n  route(\"dashboard\", \"./pages/DashboardPage/DashboardPage.tsx\"),\n  route(\"profile\", \"./pages/ProfilePage/ProfilePage.tsx\"),\n  // Add more protected routes here\n] satisfies RouteConfig;\n```\n\n### Page Component with Route Integration\n\n```typescript\n// pages/FeatureNamePage/index.tsx\nimport { useParams, useSearchParams } from \"react-router\";\nimport { ProtectedRoute } from \"../../utils/ProtectedRoute\";\nimport { Provider } from \"./provider\";\nimport { Container } from \"./Container\";\n\nexport const FeatureNamePage = () => {\n  const params = useParams();\n  const [searchParams] = useSearchParams();\n\n  return (\n    <ProtectedRoute>\n      <Provider>\n        <Container />\n      </Provider>\n    </ProtectedRoute>\n  );\n};\n\nexport default FeatureNamePage;\n```\n\n## Architecture Patterns\n\n### Context-Based Page Architecture\n1. **Page Component**: Sets up Context Provider and routing\n2. **Page Container**: Connects to context using consumer hook\n3. **Presentational Components**: Render UI based on props from context\n4. **Custom Hooks**: Encapsulate logic (forms, handlers, API calls)\n5. **Redux Integration**: Direct access with useSelector/useDispatch\n\n### Hook Responsibilities\n- **API Hooks**: RTK Query + refetch logic + fetch-related useEffect + direct Redux access\n- **Handler Hooks**: Business logic, mutations, user feedback (NO useEffect) + direct Redux dispatch\n- **Effect Hooks**: Non-fetch useEffect logic only (not related to API) + manage own dependencies (URL params, timers, events)\n- **Form Hooks**: React Hook Form integration + validation\n- **Schema Hooks**: Zod validation schemas + reusable validation patterns\n\n### Hook Self-Containment Rules\n- **API Hooks**: Access Redux state directly, no parameters needed for filters/search\n- **Handler Hooks**: Access Redux dispatch directly, no callback parameters\n- **Effect Hooks**: Import their own dependencies (useSearchParams, etc.), minimal parameters\n- **All Hooks**: Should be self-contained and manage their own state/dependencies\n\n## Error Handling\n\n- Use Zod for all runtime validation\n- Implement error boundaries for unexpected errors\n- Handle errors at the beginning of functions\n- Use early returns for error conditions\n- Provide meaningful error messages to users\n- Handle 401 errors globally in RTK Query base query\n\n### Error Boundary Component\n\n```typescript\n// components/ErrorBoundary/ErrorBoundary.tsx\nimport { Button } from \"./button\";\nimport { Card, CardContent } from \"./card\";\nimport { Component, ErrorInfo, ReactNode } from \"react\";\n\ninterface IErrorBoundaryState {\n  hasError: boolean;\n  error?: Error;\n}\n\ninterface IErrorBoundary {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\nexport class ErrorBoundary extends Component<IErrorBoundary, IErrorBoundaryState> {\n  constructor(props: IErrorBoundary) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): IErrorBoundaryState {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    console.error(\"Error caught by boundary:\", error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return this.props.fallback || (\n        <Card className=\"p-6 m-4 border-destructive\">\n          <CardContent>\n            <p className=\"text-destructive mb-4\">\n              Something went wrong. Please try refreshing the page.\n            </p>\n            <Button \n              onClick={() => this.setState({ hasError: false })}\n              variant=\"outline\"\n            >\n              Try again\n            </Button>\n          </CardContent>\n        </Card>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n```\n\n## Performance Optimization\n\n- Use React.memo() for components that don't need frequent re-renders\n- Implement code splitting with React.lazy() and Suspense\n- Optimize bundle size by importing components individually\n- Use React Hook Form's built-in performance optimizations\n- Leverage RTK Query's caching strategies\n\n```typescript\n// Code splitting example\nconst LazyFeaturePage = lazy(() => \n  import(\"./pages/FeatureNamePage\").then(module => ({\n    default: module.FeatureNamePage\n  }))\n);\n\n// In your routes\n<Suspense fallback={<CircularProgress />}>\n  <LazyFeaturePage />\n</Suspense>\n```\n\n## Authentication Architecture\n\n### Token-Based Authentication\nThis project uses token-based authentication with X-API-Token header:\n\n- **Login Flow**: User credentials are sent to `/api/login` endpoint\n- **Token Storage**: API token is stored in Redux state and persisted to localStorage\n- **Authentication Header**: Token is automatically injected as `X-API-Token` header via fetchBaseQuery\n- **Logout**: Clears token from Redux state and localStorage\n- **Global Error Handling**: 401 errors trigger automatic logout and redirect to login page\n\n### Authentication API Structure\n```typescript\n// Login Request\ninterface ILoginRequest {\n  username: string;\n  password: string;\n}\n\n// Login Response\ninterface ILoginResponse {\n  token: string;\n  user: {\n    userId: number;\n    username: string;\n    privileges: string[];\n  };\n}\n```\n\n### Authentication State Management\n```typescript\n// Auth state with token\ninterface IAuthState {\n  token: string | null;\n  user: IUserProfile | null;\n  isLoading: boolean;\n  error: string | null;\n}\n\n// User Profile\ninterface IUserProfile {\n  userId: number;\n  username: string;\n  privileges: string[];\n}\n```\n\n## Key Rules\n\n### State Management Rules\n- **Never use useState/useReducer** - use Redux slices instead\n- **No API data duplication** - RTK Query is single source of truth\n- **Access Redux directly** - use useSelector in components\n- **Share through context** - RTK Query results and handlers only\n\n### Hook Architecture Rules\n- **API hooks**: Only for data fetching + refetch logic\n- **Handlers**: Only for business logic + mutations (no useEffect)\n- **Effects**: Only for non-fetch useEffect logic\n- **Form object naming**: Always name the form object `form`\n\n### Component Organization Rules\n- **Container-specific components**: Place in the container's directory, not in global components\n- **Global components**: Only in `/app/components/` for reusable components across the app\n- **Relative imports**: Use `./ComponentName` for container-specific components\n- **Container index.ts**: Export all container components for clean imports\n\n### Code Quality Rules\n- Always use TypeScript with strict typing\n- Follow the established directory structure\n- Use consistent naming conventions\n- Implement proper error handling\n- Write accessible code with proper ARIA labels\n- Use Tailwind CSS v4 classes and CSS variables consistently\n- Follow clean code principles\n\n## Testing Guidelines\n\n- Write unit tests using Jest and React Testing Library\n- Test components with accessibility queries\n- Test form validation with Zod schemas and validation error handling\n- Use React Router testing utilities for route testing\n- Test Redux state changes and API calls\n- Test Zod schema validation with both valid and invalid data\n\n```typescript\n// Example test\nimport { render, screen } from \"@testing-library/react\";\nimport { ComponentName } from \"./ComponentName\";\n\ntest('renders component correctly', () => {\n  renderWithTheme(<ComponentName prop1=\"test\" />);\n  expect(screen.getByRole('button')).toBeInTheDocument();\n});\n```\n\n## Security Guidelines\n\n- Sanitize user inputs to prevent XSS attacks\n- Use Zod for robust input validation\n- Implement proper authentication checks in protected routes\n- Follow security best practices for handling sensitive data\n\n## Documentation References\n\n- [React Router v7 Documentation](https://reactrouter.com/dev/)\n- [React Hook Form Documentation](https://react-hook-form.com/)\n- [Zod Documentation](https://zod.dev/)\n- [Redux Toolkit Documentation](https://redux-toolkit.js.org/)\n- [Tailwind CSS Documentation](https://tailwindcss.com/)\n",
            "color": "orange",
            "tags": [],
            "isDefault": true,
            "createdAt": "2025-11-16T05:44:43.616Z",
            "applicableTo": [
              "prompt",
              "quiz",
              "followup"
            ],
            "directoryIds": [
              "fpxe8uhNUZwVzQKLs7rh"
            ],
            "updatedAt": "2025-11-16T05:45:10.375Z"
          },
          "createTime": "2025-11-16T05:44:43.636Z",
          "updateTime": "2025-11-16T05:45:10.399Z"
        },
        {
          "id": "XsmSaVMk6CdNmty8JsRr",
          "data": {
            "id": "XsmSaVMk6CdNmty8JsRr",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Design Patterns - Explanation",
            "description": "",
            "content": "# Design Pattern Explanation Generator\n\nGenerate clear design pattern explanations with TypeScript examples and ASCII diagrams.\n\n## Output Structure\n\n```markdown\n# {Pattern Name} Design Pattern\n\n## Overview\n**Definition:** {2-3 sentence definition}\n**Intent:** {Problem it solves and primary purpose}\n**Motivation:** {Real-world scenario illustrating need}\n\n## Pattern Structure\n\n### UML Diagram\n```\n┌────────────────────────────────────────────┐\n│        {Pattern Name} Structure            │\n├────────────────────────────────────────────┤\n│  ┌──────────────┐     Participants:       │\n│  │ <<interface>>│     • {Component 1}     │\n│  │ {Interface}  │     • {Component 2}     │\n│  └──────────────┘                          │\n│        △                                   │\n│        │                                   │\n│  ┌─────┴──────┐                            │\n│  │ {Concrete} │                            │\n│  └────────────┘                            │\n└────────────────────────────────────────────┘\n```\n\n### Participants\n**{Component}:** {Role and responsibilities}\n\n## TypeScript Implementation\n\n### Basic Example\n```typescript\ninterface {Interface} {\n  operation(): ReturnType;\n}\n\nclass {Implementation} implements {Interface} {\n  public operation(): ReturnType {\n    // Implementation\n  }\n}\n```\n\n### Real-World Example\n```typescript\n// {Real-world use case description}\nclass {RealWorldClass} {\n  async execute(input: InputType): Promise<OutputType> {\n    // Pattern implementation\n  }\n}\n```\n\n## Execution Flow\n\n### Sequence Diagram\n```\nClient → Pattern → Component\n  │       │         │\n  │──req─▶│         │\n  │       │──proc──▶│\n  │◀──res─│◀────────│\n```\n\n### Steps\n1. **Initialize:** {Description}\n2. **Process:** {Description}\n3. **Return:** {Description}\n\n## When to Use\n\n### ✅ Use When:\n- {Scenario 1}\n- {Scenario 2}\n\n### ❌ Avoid When:\n- {Scenario 1}\n- {Scenario 2}\n\n### Decision Chart\n```\n┌──────────────────────────────────────┐\n│  Criteria       Score  Status        │\n├──────────────────────────────────────┤\n│  Complexity     ███░░  Medium        │\n│  Performance    █████  High          │\n│  Maintainability████░  High          │\n└──────────────────────────────────────┘\n```\n\n## Benefits & Trade-offs\n\n**Benefits:**\n- {Benefit 1}: {Explanation}\n- {Benefit 2}: {Explanation}\n\n**Trade-offs:**\n- {Trade-off 1}: {Consideration}\n- {Trade-off 2}: {Consideration}\n\n### vs Alternatives\n```\n┌─────────────────────────────────────────┐\n│  Aspect      This     Alt1     Alt2    │\n├─────────────────────────────────────────┤\n│  Complexity  Medium   Low      High    │\n│  Flexibility High     Medium   High    │\n└─────────────────────────────────────────┘\n```\n\n## Common Pitfalls\n\n### Pitfall: {Name}\n**Problem:** {Description}\n```typescript\n// ❌ Wrong\nclass Bad { /* issue */ }\n```\n**Solution:** {Fix}\n```typescript\n// ✅ Correct\nclass Good { /* fixed */ }\n```\n\n## Testing Strategy\n\n```typescript\ndescribe('{Pattern}', () => {\n  it('should work correctly', () => {\n    const instance = new {Pattern}();\n    expect(instance.method()).toBe(expected);\n  });\n});\n```\n\n## Performance\n- **Time:** O({complexity})\n- **Space:** O({complexity})\n\n**Optimization:**\n```typescript\nclass Optimized {\n  private cache = new Map();\n  // Optimization technique\n}\n```\n\n## Real-World Use Cases\n\n**1. {Industry}**\n- Scenario: {Problem}\n- Solution: {How pattern solves it}\n\n**2. {Industry}**\n- Scenario: {Problem}\n- Solution: {Implementation}\n\n## Summary\n\n**Key Takeaways:**\n- 🎯 Purpose: {One-liner}\n- ✅ Use: {When to use}\n- ❌ Avoid: {When not to use}\n\n### Quick Reference\n```\n┌────────────────────────────────────────┐\n│  {Pattern Name} at a Glance           │\n├────────────────────────────────────────┤\n│  Category:    {Type}                  │\n│  Complexity:  ⭐⭐⭐☆☆                 │\n│  Best For:    {Primary use case}      │\n└────────────────────────────────────────┘\n```\n\n**Related Patterns:** {Pattern 1}, {Pattern 2}\n```\n\n## Generation Guidelines\n\n**Pattern Categories:**\n- Creational: Singleton, Factory, Builder, Prototype\n- Structural: Adapter, Decorator, Facade, Proxy\n- Behavioral: Observer, Strategy, Command, State\n\n**Code Quality:**\n- Modern TypeScript (ES2020+)\n- Type safety with generics\n- Error handling\n- Async/await where appropriate\n\n**Diagrams (minimum 3):**\n1. Structure (UML-style)\n2. Sequence (execution flow)\n3. Comparison (metrics/alternatives)\n\n**Focus Areas:**\n- Web development\n- API design\n- State management\n- Real-world scenarios\n\n**File Naming:**\n`{pattern-name}-explanation.md` (kebab-case)\n",
            "color": "yellow",
            "tags": [],
            "applicableTo": [
              "prompt"
            ],
            "isDefault": true,
            "createdAt": "2026-01-25T03:24:55.062Z",
            "directoryIds": [
              "IAmZcUL0a5hF0s2soG9V"
            ],
            "updatedAt": "2026-01-25T03:27:26.663Z"
          },
          "createTime": "2026-01-25T03:24:55.098Z",
          "updateTime": "2026-01-25T03:27:26.683Z"
        },
        {
          "id": "YOKPLB69HZrPPYPPqNix",
          "data": {
            "id": "YOKPLB69HZrPPYPPqNix",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Mandarin Text Transform ",
            "description": "",
            "content": "# Rules for AI Chinese Text Transformer\n\nThis document outlines the rules and guidelines for an AI system designed to transform input Chinese text into an annotated output format. The AI processes the text to provide linguistic annotations, grammar analysis, and visual schemas. The transformation aims to aid language learners by breaking down the text into words with pinyin and English translations, followed by sections on grammar patterns and their visualizations.\n\n## Input Requirements\n\n### Input Type\nA string of Chinese text (simplified or traditional characters). The text can be a sentence, paragraph, or short passage.\n\n### Assumptions\n- The text is in standard Mandarin Chinese.\n- No prior segmentation is provided; the AI must handle word segmentation.\n- Handle punctuation appropriately (e.g., preserve it in the output without annotation).\n\n### Edge Cases\n- **Empty input**: Return an error message like \"No Chinese text provided.\"\n- **Non-Chinese characters**: Ignore or pass through unchanged (e.g., numbers, English words).\n- **Mixed scripts**: Annotate only Chinese words.\n\n## Output Format\n\nThe output is a transformed version of the input text with annotations, followed by additional sections for grammar analysis. The entire output should be a single string or file content.\n\n### 1. Annotated Text Section\n\n#### Transformation Rule\n- Perform word segmentation on the Chinese text using a reliable method (e.g., via libraries like Jieba for Python).\n- For each segmented Chinese word:\n  - Convert the word to Pinyin (using tone marks, e.g., \"nǐ hǎo\" instead of \"ni3 hao3\").\n  - Translate the word to English (provide the most contextually appropriate translation; if ambiguous, choose the primary meaning).\n  - Format as: `[Chinese word] (Pinyin, English translation)`\n- Preserve the original order and structure of the text.\n- Non-word elements (e.g., punctuation, spaces) should be retained as-is, without annotations.\n\n#### Example\n\n**Input**: \"你好，我是学生。\"\n\n**Segmented**: 你好 (nǐ hǎo, hello)，我 (wǒ, I)是 (shì, am)学生 (xué shēng, student)。\n\n**Output Annotated Text**: `[你好] (nǐ hǎo, hello)，[我] (wǒ, I)[是] (shì, am)[学生] (xué shēng, student)。`\n\n### 2. Grammar Patterns Section\n\n#### Rule\n- Analyze the entire input text to identify key grammar patterns used.\n- List each unique pattern with:\n  - A brief description.\n  - Examples from the input text (referencing the annotated version).\n  - Common usage notes.\n\n#### Identification Guidelines\n- Use natural language processing techniques to detect patterns (e.g., subject-verb-object, use of particles like 的 (de), questions with 吗 (ma), etc.).\n- Limit to 3-5 major patterns per text to avoid overload.\n- If no patterns are detected, state \"No distinct grammar patterns identified.\"\n\n#### Format\nUse a markdown list or table.\n\n#### Example Table\n\n| Grammar Pattern | Description | Example from Text |\n|----------------|-------------|-------------------|\n| Subject-Verb-Object (SVO) | Basic sentence structure where subject precedes verb and object. | `[我] (wǒ, I)[是] (shì, am)[学生] (xué shēng, student)` – \"I am a student.\" |\n| Use of Particle 的 (de) | Indicates possession or modification. | If present, e.g., `[我的] (wǒ de, my)[书] (shū, book)` – \"My book.\" |\n\n### 3. Grammar Schemas Section\n\n#### Rule\n- For each grammar pattern identified in the previous section, provide a visual schema.\n- Schemas should illustrate the structure (e.g., sentence trees, flowcharts).\n- Use text-based representations suitable for markdown:\n  - ASCII art for simple trees.\n  - Code blocks with pseudo-diagram syntax (e.g., mimicking tree structures).\n\n#### Visualization Guidelines\n- Keep schemas simple and readable.\n- Label components with Chinese, Pinyin, and English where relevant.\n- If complex, suggest using external tools for full diagrams (but provide basic ones here).\n\n#### Format\nUse markdown code blocks for each schema.\n\n#### Example for SVO Pattern\n\n```text\nSentence Structure: Subject-Verb-Object\n+----------+     +------+     +--------+\n| Subject  | --> | Verb | --> | Object |\n+----------+     +------+     +--------+\n| [我]     |     | [是] |     | [学生] |\n| (wǒ, I)  |     | (shì,|     | (xué   |\n|          |     |  am) |     | shēng, |\n|          |     |      |     | student)|\n+----------+     +------+     +--------+\n```\n\n## Implementation Guidelines for the AI\n\n### Tools and Libraries\n- **Word Segmentation**: Use Jieba or similar.\n- **Pinyin Conversion**: Use pypinyin library.\n- **Translation**: Use a dictionary-based approach or API (e.g., Google Translate fallback, but prefer offline dict for accuracy).\n- **Grammar Analysis**: Use NLP libraries like spaCy (with Chinese models) or Stanford NLP for pattern detection.\n\n### Error Handling\n- **Invalid Chinese**: \"Input contains invalid characters; please provide valid Chinese text.\"\n- **Long Text**: Limit input to 500 characters; truncate or warn if exceeded.\n\n### Best Practices\n- Ensure translations are context-aware (e.g., \"ma\" could be \"horse\" or \"mother\" based on characters).\n- Maintain neutrality and accuracy in annotations.\n- Output should be culturally sensitive.\n\n## Testing Examples\n\n### Input 1: \"今天天气很好。\"\n\n**Expected Output:**\n\n**Annotated Text**: `[今天] (jīn tiān, today)[天气] (tiān qì, weather)[很] (hěn, very)[好] (hǎo, good)。`\n\n**Grammar Patterns:**\n\n| Pattern | Description | Example |\n|---------|-------------|---------|\n| Adverb-Adjective | Uses adverb to modify adjective. | `[很] (hěn, very)[好] (hǎo, good)` – \"Very good.\" |\n\n**Schemas:**\n\n```text\nAdverb-Adjective Schema\n+--------+     +-----------+\n| Adverb | --> | Adjective |\n+--------+     +-----------+\n| [很]   |     | [好]      |\n| (hěn,  |     | (hǎo,     |\n|  very) |     |  good)    |\n+--------+     +-----------+\n```\n",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt"
            ],
            "isDefault": true,
            "createdAt": "2025-11-16T05:00:40.650Z",
            "directoryIds": [
              "eWutknFkpiy7caou8kcX"
            ],
            "updatedAt": "2025-11-16T05:21:47.384Z"
          },
          "createTime": "2025-11-16T05:00:40.664Z",
          "updateTime": "2025-11-16T05:21:47.404Z"
        },
        {
          "id": "aO4P55DbtX0McDp2JcSP",
          "data": {
            "id": "aO4P55DbtX0McDp2JcSP",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "DSA Quiz",
            "description": "",
            "content": "# DSA (Data Structures and Algorithms) Quiz Generation Rules\n\nThese rules are specific to computer science, data structures, and algorithms quiz generation. They build upon the generic quiz rules and add domain-specific requirements for technical accuracy and pedagogical effectiveness.\n\n## DSA-Specific Question Types\n\n### Required Question Categories\nEach DSA quiz should include questions covering:\n\n1. **Algorithm Fundamentals** (2-3 questions)\n   - Core algorithmic concepts and principles\n   - Algorithm design paradigms (greedy, divide-and-conquer, dynamic programming, etc.)\n   - Problem-solving strategies\n\n2. **Data Structure Operations** (2-3 questions)\n   - Insertion, deletion, search operations\n   - Time and space complexity of operations\n   - Structure-specific characteristics\n\n3. **Complexity Analysis** (1-2 questions)\n   - Time complexity (best, average, worst case)\n   - Space complexity\n   - Big O, Big Θ, Big Ω notation\n   - Complexity comparisons between approaches\n\n4. **Implementation Details** (1-2 questions)\n   - Specific algorithm steps and procedures\n   - Edge cases and boundary conditions\n   - Algorithm invariants and correctness\n\n5. **Practical Applications** (1-2 questions)\n   - Real-world use cases\n   - When to use specific data structures/algorithms\n   - Trade-offs and design decisions\n\n## Technical Accuracy Requirements\n\n### Algorithm and Data Structure Terminology\n- ✅ **Use precise technical terminology** (e.g., \"adjacency list\", \"hash collision\", \"binary heap property\")\n- ✅ **Reference specific algorithms by their standard names** (e.g., \"Dijkstra's algorithm\", \"Quicksort\", \"Kruskal's MST\")\n- ✅ **Use correct mathematical notation** (e.g., O(n log n), Θ(n²), Ω(n))\n- ❌ **AVOID vague descriptions** like \"the sorting method\" or \"the tree structure\"\n- ❌ **NEVER use incorrect terminology** or made-up algorithm names\n\n### Code References in Questions\nWhen referencing code or pseudocode:\n- ✅ **Use function/method names without quotes**: `What does the merge() function do?`\n- ✅ **Reference data structures clearly**: `How does a hash table handle collisions?`\n- ✅ **Describe algorithmic steps precisely**: `In the quicksort partition step...`\n- ❌ **AVOID**: Wrapping code in quotes or backticks in JSON strings\n- ❌ **AVOID**: Generic descriptions that could apply to multiple algorithms\n\n**Example of GOOD code reference:**\n```\nQuestion: \"What is the time complexity of the binary search algorithm when searching in a sorted array?\"\nOptions:\nA. O(log n) due to halving search space each iteration\nB. O(n) requiring linear traversal of all elements\nC. O(n log n) from sorting and searching operations combined\nD. O(1) with constant-time direct access to target element\n```\n\n**Example of BAD code reference:**\n```\nQuestion: \"What does the \\\"search()\\\" function do in the \\\"BinarySearch\\\" class?\"\n```\n\n## Complexity Analysis Questions\n\n### Time Complexity Requirements\n- **Include complexity questions** that test understanding of:\n  - Best case, average case, worst case scenarios\n  - How algorithm behavior changes with input size\n  - Comparison between different algorithmic approaches\n\n- **Option Construction for Complexity Questions:**\n  - All options should reference complexity notation (O, Θ, Ω)\n  - Incorrect options should use plausible but wrong complexity classes\n  - Options should explain WHY the complexity is what it is\n\n**Example of GOOD complexity question:**\n```\nQuestion: \"What is the worst-case time complexity of quicksort when the pivot always selects the smallest element?\"\nOptions:\nA. O(n²) because each partition creates highly unbalanced subarrays\nB. O(n log n) maintaining balanced partitioning throughout execution\nC. O(n) achieving linear time through optimal pivot selection\nD. O(log n) reducing problem size logarithmically per iteration\n```\n\n### Space Complexity Requirements\n- Include questions about:\n  - Auxiliary space vs. input space\n  - In-place algorithms vs. algorithms requiring extra space\n  - Recursive call stack space\n\n## Data Structure-Specific Rules\n\n### Array-Based Structures\nWhen creating questions about arrays, lists, stacks, queues:\n- Test understanding of:\n  - Index-based access patterns\n  - Insertion/deletion costs at different positions\n  - Memory layout and cache behavior\n  - Dynamic vs. static sizing\n\n### Tree-Based Structures\nWhen creating questions about trees (BST, AVL, heap, etc.):\n- Test understanding of:\n  - Tree properties and invariants\n  - Traversal methods (in-order, pre-order, post-order, level-order)\n  - Height and balance properties\n  - Insertion/deletion procedures\n\n### Hash-Based Structures\nWhen creating questions about hash tables, hash maps:\n- Test understanding of:\n  - Hash function properties\n  - Collision resolution strategies (chaining, open addressing)\n  - Load factor and rehashing\n  - Average vs. worst-case performance\n\n### Graph Structures\nWhen creating questions about graphs:\n- Test understanding of:\n  - Representation methods (adjacency list vs. matrix)\n  - Traversal algorithms (BFS, DFS)\n  - Shortest path algorithms\n  - Minimum spanning tree algorithms\n\n## Algorithm-Specific Rules\n\n### Sorting Algorithms\n- Test understanding of:\n  - Algorithm steps and partitioning methods\n  - Stability and in-place properties\n  - Time/space complexity trade-offs\n  - When to use which sorting algorithm\n\n### Search Algorithms\n- Test understanding of:\n  - Prerequisites (sorted array for binary search)\n  - Search space reduction strategies\n  - Comparison with linear search\n  - Application scenarios\n\n### Graph Algorithms\n- Test understanding of:\n  - Algorithm initialization and termination conditions\n  - Data structures used (priority queue, visited set, etc.)\n  - Edge cases (disconnected graphs, negative weights, cycles)\n  - Correctness proofs and invariants\n\n## DSA Option Quality Standards\n\n### Technical Plausibility\nAll incorrect options must:\n- ✅ Use legitimate DSA concepts and terminology\n- ✅ Reference real algorithms or data structures (even if incorrectly applied)\n- ✅ Include plausible complexity claims with reasoning\n- ✅ Sound technically credible to someone with partial knowledge\n\n**Example of GOOD plausible incorrect options:**\n```\nQuestion about binary search complexity:\nA. O(log n) by halving search space each iteration (CORRECT)\nB. O(n) requiring examination of all elements sequentially\nC. O(n log n) from sorting prerequisite and logarithmic search\nD. O(1) with direct hash-based element access\n```\n\n**Example of BAD implausible options:**\n```\nQuestion about binary search:\nA. O(log n) (CORRECT)\nB. It uses recursion\nC. Arrays are faster\nD. Because it's a tree\n```\n\n### Complexity Notation in Options\n- ✅ **Always include complexity notation** (O, Θ, Ω) in complexity-related questions\n- ✅ **Provide brief reasoning** for why the complexity is what it is\n- ✅ **Use consistent notation** throughout all options\n- ❌ **AVOID**: Options without complexity notation in complexity questions\n- ❌ **AVOID**: Mixing different complexity classes without clear reasoning\n\n## Code Example Questions\n\n### Pseudocode References\nWhen questions reference algorithm pseudocode:\n- ✅ Describe the step or operation clearly\n- ✅ Use standard algorithm terminology\n- ✅ Reference specific algorithm phases (initialization, main loop, termination)\n\n**Example:**\n```\nQuestion: \"In the merge step of merge sort, what is the time complexity of merging two sorted subarrays of size n/2 each?\"\n```\n\n### Implementation Details\n- Test understanding of:\n  - Specific algorithm steps\n  - Loop invariants\n  - Base cases and recursive cases\n  - Edge case handling\n\n## Mathematical and Theoretical Questions\n\n### Algorithm Correctness\n- Include questions about:\n  - Loop invariants\n  - Termination conditions\n  - Proof techniques (induction, contradiction)\n\n### Mathematical Properties\n- Test understanding of:\n  - Graph properties (connectivity, cycles, paths)\n  - Tree properties (height, balance, ordering)\n  - Set operations and properties\n\n## Practical Application Questions\n\n### Algorithm Selection\n- Test understanding of:\n  - When to use which algorithm\n  - Trade-offs between different approaches\n  - Problem characteristics that favor specific algorithms\n\n**Example:**\n```\nQuestion: \"When would you choose a hash table over a binary search tree for implementing a dictionary?\"\nOptions:\nA. When average-case O(1) lookups are more important than sorted order\nB. When you need to maintain elements in sorted order efficiently\nC. When memory usage must be minimized regardless of performance\nD. When worst-case O(log n) guarantees are required for all operations\n```\n\n### Real-World Scenarios\n- Connect algorithms to practical problems:\n  - Route finding (shortest path algorithms)\n  - Scheduling (greedy algorithms)\n  - Resource allocation (dynamic programming)\n  - Data organization (appropriate data structure selection)\n\n## DSA-Specific Explanation Requirements\n\n### Technical Explanations\nExplanations should:\n- ✅ Reference specific algorithmic concepts\n- ✅ Explain the reasoning behind the correct answer\n- ✅ Clarify why incorrect options are wrong\n- ✅ Include relevant complexity analysis when applicable\n\n**Example of GOOD explanation:**\n```\nExplanation: \"Binary search achieves O(log n) time complexity because it eliminates half of the remaining search space in each iteration. With each comparison, the problem size is reduced by a factor of 2, leading to at most log₂(n) iterations. The incorrect options either don't account for the halving strategy (O(n)) or incorrectly assume constant-time access (O(1)).\"\n```\n\n## Integration with Generic Rules\n\nThese DSA-specific rules **extend and complement** the generic quiz rules. Always follow:\n\n1. **Generic rules** for:\n   - Option length balance\n   - Answer distribution\n   - JSON formatting\n   - Overall question structure\n\n2. **DSA-specific rules** for:\n   - Technical terminology accuracy\n   - Algorithm and data structure specifics\n   - Complexity analysis questions\n   - Domain-appropriate question types\n\n## Quality Checklist for DSA Quizzes\n\nBefore finalizing, verify:\n\n### Technical Accuracy\n- [ ] All algorithm/data structure names are correct and standard\n- [ ] Complexity notation is used correctly (O, Θ, Ω)\n- [ ] Technical terminology is precise and appropriate\n- [ ] Code references are clear and unambiguous\n\n### Question Coverage\n- [ ] Includes algorithm fundamentals questions\n- [ ] Includes data structure operation questions\n- [ ] Includes complexity analysis questions\n- [ ] Includes practical application questions\n- [ ] Covers main concepts from the source material\n\n### Option Quality\n- [ ] All options use legitimate DSA concepts\n- [ ] Incorrect options are technically plausible\n- [ ] Complexity questions include notation and reasoning\n- [ ] Options are balanced in length (per generic rules)\n- [ ] Options are topically relevant (per generic rules)\n\n### Explanations\n- [ ] Explanations reference specific algorithmic concepts\n- [ ] Explanations clarify why the answer is correct\n- [ ] Explanations distinguish from incorrect options\n- [ ] Technical accuracy is maintained in explanations\n\n",
            "color": "indigo",
            "tags": [],
            "applicableTo": [
              "quiz"
            ],
            "isDefault": true,
            "createdAt": "2025-11-16T05:09:53.764Z",
            "directoryIds": [
              "B0vn5dW2CtxFrhFimGy5",
              "myxLPjWjPisM8nbhgx2w",
              "IAmZcUL0a5hF0s2soG9V"
            ],
            "updatedAt": "2026-01-25T03:27:26.680Z"
          },
          "createTime": "2025-11-16T05:09:53.787Z",
          "updateTime": "2026-01-25T03:27:26.698Z"
        },
        {
          "id": "g5eq5EGaf16cwbHB2vyB",
          "data": {
            "id": "g5eq5EGaf16cwbHB2vyB",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "DSA Hint",
            "description": "",
            "content": "# Rule: Algorithm Solution Mistake - Playful Hint-Based Follow-Up\n\n## When to Trigger\n- After an attempt to reproduce a solution to an algorithm problem (e.g., greedy, dynamic programming) results in errors or incorrect logic.\n\n## Core Philosophy: NO SPOILERS! 🎭\n**NEVER show the correct solution directly.** Instead, use playful hints, metaphors, and guided discovery to help the user find their own \"aha!\" moments.\n\n## Steps\n\n### Step 1: Playful Mistake Detective 🕵️\n- Analyze the mistakes with humor and creativity\n- Use metaphors, analogies, or playful language to describe what went wrong\n- Give the mistake a \"personality\" or \"character flaw\"\n\n#### Example Approaches:\n- \"Your algorithm has commitment issues - it's updating the answer while still figuring out what it wants!\"\n- \"I see your code is doing the classic 'measure twice, cut once' backwards - it's cutting before measuring!\"\n- \"Your sliding window is like an eager photographer - taking pictures before the scene is properly set up!\"\n\n### Step 2: Breadcrumb Trail of Hints 🍞\n- Provide 2-3 escalating hints that guide toward the solution\n- Each hint should be more specific than the last\n- Use questions that make the user think about timing, order, or logic flow\n\n#### Hint Structure:\n1. **Gentle Nudge**: Point to the general area of the problem\n2. **Focused Hint**: Narrow down to the specific issue\n3. **Almost-There Hint**: Give just enough to spark the \"aha!\" moment\n\n### Step 3: \"What's Wrong With This Picture?\" Game 🎯\n- Present the mistake as a puzzle or game\n- Ask the user to spot the logical flaw\n- Use analogies from everyday life to make it relatable\n\n#### Example Questions:\n- \"If you were a restaurant critic, at what point would you write your review - before or after tasting the food?\"\n- \"Your algorithm is like someone announcing the winner before the race is over. Can you spot where this happens?\"\n\n### Step 4: Mini Challenge 🏆\n- Create a tiny test case that exposes the flaw\n- Let the user trace through their logic step by step\n- Encourage them to discover the issue themselves\n\n---\n\n## Enforcement Rules\n- **ABSOLUTELY NO direct code corrections** - only hints and guidance\n- **NO showing the correct implementation** - let them build it\n- **YES to creative metaphors** - make learning fun and memorable\n- **YES to step-by-step discovery** - guide them to their own insights\n\n## Tone Guidelines\n- Be encouraging and playful, never condescending\n- Use emojis and fun language to keep it light\n- Celebrate small discoveries along the way\n- Make mistakes feel like puzzles to solve, not failures\n\n## Documentation\n- Create followup files that capture the hint-giving process\n- Include the metaphors and analogies used\n- Document the user's discovery journey\n- Name files: `followup-[problem-name]-hints.md`\n\n## Notes\n- Don't modify the file with mistakes - it's evidence for the detective work!\n- Don't create any file with correct solution - that's cheating!\n- Focus on the journey of discovery, not the destination",
            "color": "green",
            "tags": [],
            "applicableTo": [
              "prompt"
            ],
            "isDefault": true,
            "createdAt": "2026-01-21T04:43:45.530Z",
            "directoryIds": [
              "qfeIoVezZGoIcmetO15i",
              "IjabiYzasKrUHb9zItU4"
            ],
            "updatedAt": "2026-01-21T07:02:14.483Z"
          },
          "createTime": "2026-01-21T04:43:45.569Z",
          "updateTime": "2026-01-21T07:02:14.506Z"
        },
        {
          "id": "t09JvHwmZXILUg2N8pem",
          "data": {
            "id": "t09JvHwmZXILUg2N8pem",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Cantonese Colloq Expr",
            "description": "",
            "content": "# Rules for AI Cantonese Expression Usage Examples Generator\n\n## IMPORTANT: This is a MANDATORY Rule\n\n**This document defines a mandatory rule that MUST be applied when generating usage examples for Cantonese colloquial expressions.** When the AI receives a Cantonese colloquial expression as input, it MUST generate 5-6 different example sentences demonstrating various contexts and usages of that expression.\n\n**IMPORTANT**: This rule must be used in conjunction with `cantonese-text-transformation.md` which defines mandatory transformation rules for annotating Cantonese text. All generated example sentences MUST be processed using the transformation rules defined in `cantonese-text-transformation.md`.\n\n**IMPORTANT**: This rule must also be used in conjunction with `annotated-text-overflow-wrapping.md` which defines mandatory markdown formatting requirements for the \"Annotated Text\" section.\n\n### Rule Summary\n\nWhen given a Cantonese colloquial expression as input:\n1. **MUST** generate 5-6 different example sentences showing various usages of that expression\n2. **MUST** apply the transformation rules from `cantonese-text-transformation.md` to annotate each example sentence\n3. **MUST** ensure examples demonstrate different contexts, grammatical structures, and usage patterns\n4. **MUST** provide natural, contextually appropriate examples that reflect real Cantonese speech\n\nThe AI processes the input to help language learners understand how colloquial expressions are used in different contexts, providing multiple examples with proper annotations for comprehensive learning.\n\n## Input Requirements\n\n### Input Type\nA Cantonese colloquial expression provided directly as input. The expression may be:\n- A single word or phrase\n- A multi-word expression\n- An expression that may appear in different grammatical positions\n\n### Assumptions\n- The colloquial expression is already identified and provided as input\n- The expression is in Cantonese (colloquial form)\n- The AI should understand the meaning and usage context of the expression\n- Examples should be generated in natural Cantonese speech patterns\n- All examples must be grammatically correct and contextually appropriate\n\n### Edge Cases\n- **Empty input**: Return an error message like \"No Cantonese expression provided.\"\n- **Invalid expression**: If the expression is unclear or invalid, return an error message.\n\n## Output Format\n\nThe output consists of:\n1. **Usage Examples**: 5-6 example sentences demonstrating different usages\n2. **Annotated Examples**: Each example sentence annotated using the transformation rules from `cantonese-text-transformation.md`\n\n### 1. Usage Examples Section\n\n#### Rule (MANDATORY)\n- **MUST** generate exactly 5-6 different example sentences\n- Each example **MUST** demonstrate a different usage context or grammatical structure\n- Examples **MUST** be natural and reflect real Cantonese speech patterns\n- Examples **MUST** show variety in:\n  - Sentence types (statements, questions, exclamations)\n  - Grammatical positions (beginning, middle, end of sentence)\n  - Contexts (formal, informal, emphasis, doubt, confirmation)\n  - Verb tenses and aspects (with particles like 咗, 緊, 過)\n- Examples should be progressively more complex or show different nuances\n\n#### Format\nUse a numbered list (1-6) with each example sentence clearly separated.\n\n#### Example Structure\n\n**Example Sentences:**\n\n1. [Statement with emphasis]\n2. [Question form]\n3. [Negative statement]\n4. [With aspect particles]\n5. [In different sentence position]\n6. [Complex sentence structure]\n\n### 2. Annotated Examples Section\n\n#### Rule (MANDATORY)\n- **MUST** apply the transformation rules from `cantonese-text-transformation.md` to each example sentence\n- **MUST** follow the markdown formatting requirements from `annotated-text-overflow-wrapping.md`\n\n#### Format\nFor each example, provide:\n1. The plain Cantonese sentence\n2. The annotated version following the transformation rules from `cantonese-text-transformation.md`\n\n## Implementation Guidelines for the AI\n\n### Example Generation Strategy\n1. **Start with basic usage**: Simple statement using the expression\n2. **Vary sentence types**: Include questions, negatives, exclamations\n3. **Change positions**: Use expression at different positions in sentences\n4. **Add complexity**: Include aspect particles, modal particles, or complex structures\n5. **Show nuances**: Demonstrate different shades of meaning or emphasis\n6. **Ensure naturalness**: All examples must sound natural in Cantonese\n\n### Error Handling\n- **Invalid input**: \"Input contains invalid characters; please provide valid Cantonese expression.\"\n- **Expression too rare**: Use linguistic knowledge to generate appropriate examples, noting if the expression is uncommon\n\n### Best Practices\n- Ensure all examples are contextually appropriate and natural-sounding\n- Vary the complexity and structure of examples to show different usage patterns\n- Use the expression in different grammatical contexts\n- Include examples that show the expression's typical collocations\n- **Always apply transformation rules**: Every example must be annotated according to `cantonese-text-transformation.md`\n- **Follow formatting rules**: All annotated text must follow `annotated-text-overflow-wrapping.md` requirements\n\n## Testing Examples\n\n### Input: \"真係\"\n\n**Expected Output:**\n\n**Example Sentences:**\n\n1. 佢真係好叻！\n2. 你真係要去？\n3. 呢本書真係好睇。\n4. 我唔係真係想走。\n5. 佢真係做咗好多嘢。\n6. 真係？我唔信喎。\n\n**Annotated Examples:**\n\nEach example sentence should be annotated according to the transformation rules defined in `cantonese-text-transformation.md` and formatted according to `annotated-text-overflow-wrapping.md`.\n\n---\n\n### Input: \"點解\"\n\n**Expected Output:**\n\n**Example Sentences:**\n\n1. 你點解咁遲？\n2. 點解你唔嚟？\n3. 我唔明點解佢會咁做。\n4. 點解今日咁熱？\n5. 你點解要咁做？\n6. 點解會咁？\n\n**Annotated Examples:**\n\nEach example sentence should be annotated according to the transformation rules defined in `cantonese-text-transformation.md` and formatted according to `annotated-text-overflow-wrapping.md`.\n\n---\n\n## Integration with Other Rules\n\n### Required Rule Integration\n\n1. **cantonese-text-transformation.md**: \n   - **MUST** be applied to all example sentences\n   - The transformation rules will be provided separately\n\n2. **annotated-text-overflow-wrapping.md**:\n   - **MUST** be followed for formatting annotated text\n   - The formatting rules will be provided separately\n\n### Rule Application Order\n\n1. **Receive input**: Cantonese colloquial expression\n2. **Generate examples**: Create 5-6 varied example sentences\n3. **Apply transformation**: Use `cantonese-text-transformation.md` rules to annotate each example\n4. **Apply formatting**: Use `annotated-text-overflow-wrapping.md` rules to format the output\n5. **Output result**: Structured document with example sentences and annotated versions\n\n## Notes\n\n- This rule focuses specifically on generating usage examples for colloquial expressions\n- The expression is provided as input - no identification needed\n- Transformation and formatting rules are provided separately and must be applied\n- Examples should prioritize naturalness and real-world usage over grammatical complexity\n- All output must be educational and helpful for language learners\n\n",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "prompt"
            ],
            "isDefault": true,
            "createdAt": "2025-11-30T06:00:38.074Z",
            "directoryIds": [
              "3owHbgwAI4INYORBUdOx"
            ],
            "updatedAt": "2025-11-30T06:01:24.360Z"
          },
          "createTime": "2025-11-30T06:00:38.090Z",
          "updateTime": "2025-11-30T06:01:24.375Z"
        },
        {
          "id": "t8belCz5Lf5WYhHYGV3p",
          "data": {
            "id": "t8belCz5Lf5WYhHYGV3p",
            "userId": "fkJUAbAapgRx1HKnP7lr68M9sTM2",
            "name": "Quiz Generic",
            "description": "",
            "content": "# Generic Quiz Generation Rules\n\nThese rules apply to all quiz generation regardless of subject matter. They ensure consistent quality, proper formatting, and effective assessment design.\n\n## Core Quiz Structure\n\n### Question Count and Format\n1. **Question Range**: Generate 8-12 multiple-choice questions per quiz\n2. **Answer Options**: Each question must have exactly 4 answer options (A, B, C, D)\n3. **Single Correct Answer**: Only one option should be correct per question\n4. **Difficulty Variation**: Questions should vary in difficulty\n   - Some basic recall questions\n   - Some requiring deeper understanding and analysis\n   - Some application-based questions\n\n### Question Content Guidelines\n1. **Coverage**: Include questions about:\n   - Main ideas and central concepts\n   - Supporting details and evidence\n   - Conclusions and implications\n   - Practical applications (when relevant)\n2. **Avoid**: Overly specific details that aren't central to the main points\n3. **Clarity**: Questions must be clear, concise, and grammatically correct\n4. **Mandatory Explanations**: Each question MUST include a brief explanation of why the correct answer is right\n\n## Critical Option Quality Requirements\n\n### Equal Length Rule (MANDATORY)\n- ✅ **ALL four options must be approximately the same length (within 5-10 words of each other)**\n- ✅ **Count words in each option and balance them accordingly**\n- ❌ **NEVER make the correct answer significantly longer or shorter than others**\n- ❌ **AVOID: Short options mixed with very long explanatory options**\n\n**Example of GOOD balanced options:**\n```\nA. The algorithm uses Floyd's cycle detection method\nB. The array elements represent linked list node pointers  \nC. The pigeonhole principle guarantees duplicate number existence\nD. The two-pointer technique identifies the cycle intersection\n```\n\n**Example of BAD unbalanced options:**\n```\nA. Positive integers\nB. Sorted array\nC. There are n+1 numbers in range [1,n], ensuring at least one duplicate according to pigeonhole principle\nD. Unique numbers\n```\n\n### Plausible Incorrect Options (MANDATORY)\n- ✅ **All incorrect options must be topically relevant and contextually related**\n- ✅ **Use concepts, terminology, and ideas from the same domain/article**\n- ✅ **Make incorrect options sound reasonable to someone with partial knowledge**\n- ✅ **Base incorrect options on common misconceptions or related concepts**\n- ❌ **NEVER use completely unrelated or nonsensical options**\n- ❌ **AVOID: Generic options that don't relate to the specific question context**\n\n**Example of GOOD plausible incorrect options:**\n- All options discuss relevant concepts from the same domain\n- Each option uses domain-specific terminology appropriately\n- Incorrect options represent believable alternative explanations\n\n**Example of BAD irrelevant incorrect options:**\n- Mixing domain concepts with unrelated topics\n- Using overly generic statements that could apply to anything\n- Including options that don't use relevant technical vocabulary\n\n### Option Construction Process\n**Step 1**: Write the correct answer with appropriate length and detail\n\n**Step 2**: Create 3 incorrect options using these strategies:\n- **Strategy A**: Take a related but incorrect concept from the source material\n- **Strategy B**: Use a common misconception about the topic\n- **Strategy C**: Apply the same domain but wrong context/application\n\n**Step 3**: Ensure all 4 options are similar in word count and structure\n\n**Step 4**: Verify incorrect options sound plausible but are clearly wrong to knowledgeable readers\n\n## Answer Distribution\n\n### Random Distribution Pattern\n- **MANDATORY**: Follow the pre-determined pattern for correct answers to ensure random distribution\n- **Implementation**: Generate question content first, then assign correct answer based on pattern\n- **Verification**: Ensure roughly equal distribution across all options (A, B, C, D)\n- **Avoid Clustering**: No more than 2 consecutive questions with the same correct answer option\n\n### Answer Distribution Process\n1. **Generate the question content** first (question text, all 4 options, explanation)\n2. **Identify which option should be correct** based on the distribution pattern\n3. **Ensure the content of that designated option is factually correct** and the other 3 options are plausible but incorrect\n4. **Set the correctAnswer field** to match the pattern (0=A, 1=B, 2=C, 3=D)\n\n## JSON Formatting Rules\n\n### Critical JSON Requirements\n- Return ONLY valid JSON, no additional text or markdown formatting\n- Ensure the JSON is properly formatted and parseable\n- **ALL string values MUST be wrapped in double quotes**\n- **NEVER use unquoted text in JSON**\n- **NEVER use double quotes (\") inside JSON string values**\n- **NEVER use backticks inside JSON string values**\n- **NEVER use escaped quotes (\\\") inside JSON string values**\n\n### Array Values - Critical\n- ❌ WRONG: `[\"Option 1\", Send(), \"Option 3\"]` (unquoted function name)\n- ❌ WRONG: `[\"Option 1\", Some Value, \"Option 3\"]` (unquoted text)\n- ✅ CORRECT: `[\"Option 1\", \"Send()\", \"Option 3\"]` (all quoted)\n- ✅ CORRECT: `[\"Option 1\", \"Some Value\", \"Option 3\"]` (all quoted)\n\n### Code/Function References\n- ❌ WRONG: `\"What does the \\\"GetUser()\\\" function do?\"`\n- ❌ WRONG: `\"The \\\"main\\\" function handles...\"`  \n- ❌ WRONG: `\"What is the purpose of the \\`setTimeout\\` method?\"`\n- ✅ CORRECT: `\"What does the GetUser() function do?\"`\n- ✅ CORRECT: `\"The main function handles...\"`\n- ✅ CORRECT: `\"What is the purpose of the setTimeout method?\"`\n- ✅ CORRECT: `\"What does the user retrieval function do?\"`\n- ✅ CORRECT: `\"The primary function handles...\"`\n\n### JSON Structure Requirements\n- **ENSURE COMMAS**: Every object in arrays must be separated by commas\n- **ENSURE COMMAS**: Every string in arrays must be separated by commas\n- The `correctAnswer` field should be an integer (0, 1, 2, or 3) indicating the index of the correct option\n- **MANDATORY**: Every question must have an `explanation` field\n\n## Required JSON Format\n\n```json\n{\n  \"title\": \"Quiz Title Based on Source Material\",\n  \"questions\": [\n    {\n      \"question\": \"Question text here?\",\n      \"options\": [\n        \"Option A with approximately equal length and relevant content\",\n        \"Option B with similar length and plausible alternative explanation\", \n        \"Option C maintaining consistent length with topically relevant information\",\n        \"Option D providing comparable length with contextually appropriate details\"\n      ],\n      \"correctAnswer\": 0,\n      \"explanation\": \"Brief explanation of why this answer is correct (MANDATORY)\"\n    }\n  ]\n}\n```\n\n## Option Quality Validation Checklist\n\nBefore finalizing JSON, verify each question meets these requirements:\n\n### Length Check\n- Count words in each option: [A: X words, B: Y words, C: Z words, D: W words]\n- Ensure difference between longest and shortest option is ≤ 10 words\n- If imbalanced, rephrase options to achieve similar lengths\n\n### Relevance Check\n- All incorrect options use terminology from the source material/domain\n- No generic or completely unrelated options\n- Each incorrect option represents a plausible alternative explanation\n\n### Quality Examples\n\n**GOOD Option Set:**\n```json\n\"options\": [\n  \"The algorithm employs Floyd's cycle detection for duplicate identification\",\n  \"The pigeonhole principle guarantees existence of duplicate values systematically\", \n  \"The array structure creates implicit linked list representation naturally\",\n  \"The two-phase approach enables efficient O(1) space complexity solution\"\n]\n```\n\n**BAD Option Set to AVOID:**\n```json\n\"options\": [\n  \"Yes\",\n  \"Because there are n+1 numbers in the range [1,n], ensuring at least one number appears twice according to the pigeonhole principle which is a fundamental mathematical concept\",\n  \"No\", \n  \"To sort the array\"\n]\n```\n\n## Final Quality Checklist\n\nBefore submitting the quiz, complete these verifications:\n\n### 1. Option Length Verification\n- Count words in each option set\n- Ensure all options in each question are within 5-10 words of each other\n- Rephrase if any option is significantly longer/shorter\n\n### 2. Option Relevance Verification\n- Check that ALL incorrect options relate to the source material topic\n- Ensure incorrect options use appropriate terminology\n- Verify no generic or nonsensical options exist\n\n### 3. Answer Distribution Verification\n- Count correct answers per option (A, B, C, D)\n- Ensure roughly equal distribution\n- Check for clustering (no more than 2 consecutive same answers)\n\n### 4. Explanation Quality Verification\n- Every question has detailed explanation\n- Explanations clarify why correct answer is right\n- Explanations help distinguish from incorrect options\n\n### 5. JSON Format Verification\n- Valid JSON syntax (no parsing errors)\n- All strings properly quoted\n- No special characters that break JSON\n- Proper comma placement\n- All required fields present\n\n## Core Principle\n\n**A well-crafted quiz question should be answerable by someone knowledgeable but not easily guessed through option length or relevance disparities.**\n\nThe quiz should test genuine understanding, not pattern recognition or guessing based on option characteristics.\n\n",
            "color": "blue",
            "tags": [],
            "applicableTo": [
              "quiz"
            ],
            "isDefault": true,
            "createdAt": "2025-11-16T05:08:59.646Z",
            "directoryIds": [
              "B0vn5dW2CtxFrhFimGy5",
              "myxLPjWjPisM8nbhgx2w"
            ],
            "updatedAt": "2025-11-16T05:47:57.819Z"
          },
          "createTime": "2025-11-16T05:08:59.669Z",
          "updateTime": "2025-11-16T05:47:57.840Z"
        }
      ]
    }
  }
]